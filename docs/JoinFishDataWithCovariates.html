<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Join Fish and Env. Data – YCT Productivity - Redd Counts</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ReddCountsRicker.html" rel="next">
<link href="./FlowTemp_Covariates.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2486e1f0a3ee9ee1fc393803a1361cdb.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-6561bbde787c299e21493071c8edc6ff.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a80106726509dab1d2ad658cd225c2ab.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean"
}
</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">

<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>

<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">

<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>

<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>

<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">

<script src="site_libs/leaflet-binding-2.2.2/leaflet.js"></script>

<script src="site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>

<script src="site_libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>

<link href="site_libs/HomeButton-0.0.1/home-button.css" rel="stylesheet">

<script src="site_libs/HomeButton-0.0.1/home-button.js"></script>

<script src="site_libs/HomeButton-0.0.1/easy-button-src.min.js"></script>

<script src="site_libs/clipboard-0.0.1/setClipboardText.js"></script>

<link href="site_libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet">

<link href="site_libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet">



</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./FlowTemp_Covariates.html">Data</a></li><li class="breadcrumb-item"><a href="./JoinFishDataWithCovariates.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Join Fish and Env. Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">YCT Productivity - Redd Counts</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FlowTemp_Covariates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Environmental Covariates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./JoinFishDataWithCovariates.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Join Fish and Env. Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ReddCountsRicker.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Stock-Recruitment Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Projections</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ClimateProjectionData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Future Climate Projections</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#redd-count-data" id="toc-redd-count-data" class="nav-link active" data-scroll-target="#redd-count-data"><span class="header-section-number">3.1</span> Redd Count Data</a></li>
  <li><a href="#covariate-data" id="toc-covariate-data" class="nav-link" data-scroll-target="#covariate-data"><span class="header-section-number">3.2</span> Covariate Data</a>
  <ul class="collapse">
  <li><a href="#check-correlation" id="toc-check-correlation" class="nav-link" data-scroll-target="#check-correlation"><span class="header-section-number">3.2.1</span> Check correlation</a></li>
  <li><a href="#test-specific-variables" id="toc-test-specific-variables" class="nav-link" data-scroll-target="#test-specific-variables"><span class="header-section-number">3.2.2</span> Test specific variables</a></li>
  <li><a href="#lag-correlations" id="toc-lag-correlations" class="nav-link" data-scroll-target="#lag-correlations"><span class="header-section-number">3.2.3</span> Lag correlations</a></li>
  </ul></li>
  <li><a href="#select-covariates-and-standardize" id="toc-select-covariates-and-standardize" class="nav-link" data-scroll-target="#select-covariates-and-standardize"><span class="header-section-number">3.3</span> Select Covariates and Standardize</a></li>
  <li><a href="#join-covariate-and-fish-data" id="toc-join-covariate-and-fish-data" class="nav-link" data-scroll-target="#join-covariate-and-fish-data"><span class="header-section-number">3.4</span> Join Covariate and Fish Data</a>
  <ul class="collapse">
  <li><a href="#separate-natural-and-managed-flow-components" id="toc-separate-natural-and-managed-flow-components" class="nav-link" data-scroll-target="#separate-natural-and-managed-flow-components"><span class="header-section-number">3.4.1</span> Separate natural and managed flow components</a></li>
  <li><a href="#experienced-flow" id="toc-experienced-flow" class="nav-link" data-scroll-target="#experienced-flow"><span class="header-section-number">3.4.2</span> Experienced flow</a></li>
  <li><a href="#write-out-data-files" id="toc-write-out-data-files" class="nav-link" data-scroll-target="#write-out-data-files"><span class="header-section-number">3.4.3</span> Write out data files</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./FlowTemp_Covariates.html">Data</a></li><li class="breadcrumb-item"><a href="./JoinFishDataWithCovariates.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Join Fish and Env. Data</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Join Fish and Env. Data</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Purpose: join redd count and environmental covariate data and explore correlations between key environmental variables.</p>
<section id="redd-count-data" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="redd-count-data"><span class="header-section-number">3.1</span> Redd Count Data</h2>
<p>Load YCT redd count data and plot time series</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>redds <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/ReddCounts_WGFD_1971-2021_cleaned.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Cody"</span>, <span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>)) <span class="co"># drop Cody (too few data points) and Salt River tribs</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>redds <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> reddspermile)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> reddspermile)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> stream, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Map sites:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>reddlocs <span class="ot">&lt;-</span> redds <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(stream) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">lat =</span> <span class="fu">unique</span>(lat), <span class="at">long =</span> <span class="fu">unique</span>(long)) <span class="co"># summarize location data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>reddlocs_sp <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(reddlocs, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"long"</span>, <span class="st">"lat"</span>), <span class="at">crs =</span> <span class="st">"+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># st_write(reddlocs_sp, "Redd Counts Ricker/Spatial/ReddCounts_SpatialLocations.shp", append = FALSE)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mapview</span>(reddlocs_sp) <span class="co"># map</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-d3a0639baa83a5fb382e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d3a0639baa83a5fb382e">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["point",440]},{"method":"addCircleMarkers","args":[[43.55623017,43.66881478,43.42787225,43.72893903,43.5467974,43.54300482,43.54701598,43.54628223,43.52638051,43.56333321,43.683012,43.4270652,43.67985923],[-110.7882611,-110.6986929,-110.8246243,-110.6741424,-110.8469954,-110.7255992,-110.7867088,-110.7843594,-110.7321466,-110.792471,-110.70152,-110.8209696,-110.7077563],6,null,"reddlocs_sp",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"point","stroke":true,"color":"#333333","weight":1,"opacity":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9],"fill":true,"fillColor":["#4B0055","#46226A","#353E7C","#00588B","#007094","#008798","#009B95","#00AE8C","#00BE7D","#53CC67","#96D84B","#CDE030","#FDE333"],"fillOpacity":[0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6]},null,null,["<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>stream&emsp;<\/th><td>3 Channel&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>2&emsp;<\/td><\/tr><tr><td>1<\/td><th>stream&emsp;<\/th><td>Blacktail&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>3&emsp;<\/td><\/tr><tr><td>1<\/td><th>stream&emsp;<\/th><td>Blue Crane&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>4&emsp;<\/td><\/tr><tr><td>1<\/td><th>stream&emsp;<\/th><td>Cowboy Cabin&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>5&emsp;<\/td><\/tr><tr><td>1<\/td><th>stream&emsp;<\/th><td>Fish&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>6&emsp;<\/td><\/tr><tr><td>1<\/td><th>stream&emsp;<\/th><td>Flat&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>7&emsp;<\/td><\/tr><tr><td>1<\/td><th>stream&emsp;<\/th><td>Little Bar BC&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>8&emsp;<\/td><\/tr><tr><td>1<\/td><th>stream&emsp;<\/th><td>Lower Bar BC&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>9&emsp;<\/td><\/tr><tr><td>1<\/td><th>stream&emsp;<\/th><td>Nowlin&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>10&emsp;<\/td><\/tr><tr><td>1<\/td><th>stream&emsp;<\/th><td>Price&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>11&emsp;<\/td><\/tr><tr><td>1<\/td><th>stream&emsp;<\/th><td>Snake River Side Channel&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>12&emsp;<\/td><\/tr><tr><td>1<\/td><th>stream&emsp;<\/th><td>Spring&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>13&emsp;<\/td><\/tr><tr><td>1<\/td><th>stream&emsp;<\/th><td>Upper Bar BC&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>"],{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["3 Channel","Blacktail","Blue Crane","Cowboy Cabin","Fish","Flat","Little Bar BC","Lower Bar BC","Nowlin","Price","Snake River Side Channel","Spring","Upper Bar BC"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-110.8469954,43.4270652,-110.6741424,43.72893903,true,"reddlocs_sp","Zoom to reddlocs_sp","<strong> reddlocs_sp <\/strong>","bottomright"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],"reddlocs_sp",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addLegend","args":[{"colors":["#4B0055","#46226A","#353E7C","#00588B","#007094","#008798","#009B95","#00AE8C","#00BE7D","#53CC67","#96D84B","#CDE030","#FDE333"],"labels":["3 Channel","Blacktail","Blue Crane","Cowboy Cabin","Fish","Flat","Little Bar BC","Lower Bar BC","Nowlin","Price","Snake River Side Channel","Spring","Upper Bar BC"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"reddlocs_sp","extra":null,"layerId":null,"className":"info legend","group":"reddlocs_sp"}]}],"limits":{"lat":[43.4270652,43.72893903],"lng":[-110.8469954,-110.6741424]},"fitBounds":[43.4270652,-110.8469954,43.72893903,-110.6741424,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</div>
</div>
<p>Explore autocorrelation, which may be due to stock-recruit dynamics, autocorrelated environmental drivers, or both</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">unique</span>(redds<span class="sc">$</span>stream)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.5</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">3.5</span>,<span class="fl">3.5</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sites)) {</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">filter</span>(redds, stream <span class="sc">==</span> sites[i])</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">acf</span>(d<span class="sc">$</span>reddsperkm, <span class="at">lag.max =</span> <span class="dv">6</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="at">na.action =</span> na.pass)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> sites[i], <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>For each site, add years in which data was not collected, then calculate lagged redds</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>lagg <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>rlist <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">unique</span>(redds<span class="sc">$</span>stream)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sites)) {</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">filter</span>(redds, stream <span class="sc">==</span> sites[i])</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  df1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">year =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(d<span class="sc">$</span>year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">to =</span> <span class="fu">max</span>(d<span class="sc">$</span>year, <span class="at">na.rm =</span> T), <span class="at">by =</span> <span class="dv">1</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  rlist[[i]] <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(d) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stream =</span> sites[i], </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">miles =</span> <span class="fu">unique</span>(d<span class="sc">$</span>miles), </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">kms =</span> <span class="fu">unique</span>(d<span class="sc">$</span>kms), </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">lat =</span> <span class="fu">unique</span>(d<span class="sc">$</span>lat), </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">long =</span> <span class="fu">unique</span>(d<span class="sc">$</span>long),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">reddsperkm_lag4 =</span> <span class="fu">lag</span>(reddsperkm, <span class="at">n =</span> lagg))</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>redds2 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(rlist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Explore the effect of spawners on productivity to motivate use of Ricker model, <em>sensu</em> Jones <em>et al.</em> (2020).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># recruits ~ spawners, combined</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># redds2 %&gt;% ggplot(aes(x = reddsperkm_lag4, y = reddsperkm)) +</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(colour = stream)) +</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_smooth(method = "loess")</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># recruits ~ spawners, by stream</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># redds2 %&gt;% ggplot(aes(x = reddsperkm_lag4, y = reddsperkm)) + </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(colour = year)) + </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_smooth() +</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(~stream, scales = "free")</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # productivity ~ time, by stream</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># redds2 %&gt;% ggplot(aes(x = year, y = log(reddsperkm/reddsperkm_lag4))) + </span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(colour = year)) + </span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_smooth() +</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(~stream, scales = "free_y")</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># productivity ~ spawning stock, combined</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># redds2 %&gt;% ggplot(aes(x = reddsperkm_lag4, y = log(reddsperkm/reddsperkm_lag4))) + </span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_smooth(method = "lm") +</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(colour = stream))</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># productivity ~ spawning stock, by stream</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>redds2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> reddsperkm_lag4, <span class="at">y =</span> <span class="fu">log</span>(reddsperkm<span class="sc">/</span>reddsperkm_lag4), <span class="at">colour =</span> year)) <span class="sc">+</span> </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> year)) <span class="sc">+</span> </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>stream, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Get range of years by site</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>redds2 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(stream) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">start =</span> <span class="fu">min</span>(year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">stop =</span> <span class="fu">max</span>(year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 3
   stream                   start  stop
   &lt;chr&gt;                    &lt;dbl&gt; &lt;dbl&gt;
 1 3 Channel                 1973  2014
 2 Blacktail                 1973  2016
 3 Blue Crane                1985  2015
 4 Cowboy Cabin              1980  2016
 5 Fish                      1984  2016
 6 Flat                      1976  2015
 7 Little Bar BC             1978  2016
 8 Lower Bar BC              1971  2021
 9 Nowlin                    1976  2015
10 Price                     1975  2006
11 Snake River Side Channel  1986  2002
12 Spring                    1988  2007
13 Upper Bar BC              1974  2016</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>minby <span class="ot">&lt;-</span> <span class="fu">min</span>(redds2<span class="sc">$</span>year) <span class="sc">-</span> <span class="dv">4</span> <span class="co"># minimum brood year</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="covariate-data" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="covariate-data"><span class="header-section-number">3.2</span> Covariate Data</h2>
<p>Per Murdoch et al (2023) CJFAS, only include variables for which Pearson’s r is &lt; 0.6.</p>
<p>Notes: * drop jld_winmean and natq_winmean from same model (pearson r = 0.639 since 1960, 0.79 since 1989)</p>
<p>Load derived data files</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>jldramp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/Derived/JLD_RampDown_Summary_CalendarYear_1960-2022.csv"</span>) <span class="co">#%&gt;% mutate(broodyr = year) %&gt;% select(-year)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>jldflow <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/Derived/JLD_ManagedFlow_Covariates_BroodYear_1960-2022.csv"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>natflow <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/Derived/SnakeTribs_NaturalFlow_Covariates_BroodYear_1960-2022.csv"</span>) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">flowstn =</span> site) <span class="co">#%&gt;% filter(site %in% c("SnakeBeFlat", "Salt")) </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>airtemp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/Derived/AirTemperature_Covariates_BroodYear_1960-2022.csv"</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"moose"</span>, <span class="st">"afton"</span>)) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">tempstn =</span> site) </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(natflow<span class="sc">$</span>flowstn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Buffalo"     "Fish"        "Flat"        "Greys"       "GrosVentre" 
[6] "Salt"        "SnakeBeFlat" "SnakeMoran"  "SnakeNat"   </code></pre>
</div>
</div>
<section id="check-correlation" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="check-correlation"><span class="header-section-number">3.2.1</span> Check correlation</h3>
<p>Use pairs plots to check correlation among key variables, within datasets:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Ramp-down: complete</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Ramp-down: post-1989</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">JLD flow: complete</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">JLD flow: post-1989</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Nat. flow: complete</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">Nat. flow: post-1989</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false">Comb. flow: complete</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-8" role="tab" aria-controls="tabset-1-8" aria-selected="false">Comb. flow: post-1989</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-9" role="tab" aria-controls="tabset-1-9" aria-selected="false">Temp: complete</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-10-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-10" role="tab" aria-controls="tabset-1-10" aria-selected="false">Temp: post-1989</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(jldramp <span class="sc">%&gt;%</span> <span class="fu">select</span>(jld_rampdur, jld_rampratemindoy, jld_rampratemin_log), <span class="at">progress =</span> <span class="cn">FALSE</span> ) <span class="co"># entire time series</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(jldramp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(jld_rampdur, jld_rampratemindoy, jld_rampratemin_log) , <span class="at">progress =</span> <span class="cn">FALSE</span>) <span class="co"># post-1989</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(jld_winmean, jld_winmin, jld_winvar, jld_summean, jld_peakmag, jld_peaktime), <span class="at">progress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(jldflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(jld_winmean, jld_winvar, jld_summean, jld_peakmag, jld_peaktime), <span class="at">progress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(natq_annmin, natq_winmean, natq_winvar, natq_peakmag, natq_peaktime), <span class="at">progress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>, flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(natq_winmean, natq_winvar, natq_peakmag, natq_peaktime), <span class="at">progress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeBeFlat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(natq_winmean, natq_winvar, natq_peakmag, natq_peaktime), <span class="at">progress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-8-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>, flowstn <span class="sc">==</span> <span class="st">"SnakeBeFlat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(natq_winmean, natq_winvar, natq_peakmag, natq_peaktime), <span class="at">progress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-9-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(airtemp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(tempstn <span class="sc">==</span> <span class="st">"moose"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(temp_falmean, temp_winmean, temp_sprmean, temp_summean), <span class="at">progress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-10" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-10-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(airtemp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>, tempstn <span class="sc">==</span> <span class="st">"moose"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(temp_falmean, temp_winmean, temp_sprmean, temp_summean), <span class="at">progress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Check correlation among variables across datasets:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> jldramp <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_rampdur, jld_rampratemindoy, jld_rampratemin_log) <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_winmin, jld_summean, jld_peakmag, jld_peaktime)) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, natq_peakmag, natq_peaktime)) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>          <span class="co">#left_join(natflow %&gt;% filter(flowstn == "SnakeBeFlat") %&gt;% select(broodyr, natq_winmean)) %&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(airtemp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(tempstn <span class="sc">==</span> <span class="st">"moose"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, temp_falmean, temp_winmean, temp_sprmean, temp_summean))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(<span class="fu">cor</span>(p, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)[<span class="fu">upper.tri</span>(<span class="fu">cor</span>(p, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>))])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.5061091  0.5862950</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(p, <span class="at">progress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Post 1989</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> jldramp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_rampdur, jld_rampratemindoy, jld_rampratemin_log) <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(jldflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_winmin, jld_summean, jld_peakmag, jld_peaktime)) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, natq_peakmag, natq_peaktime)) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>          <span class="co">#left_join(natflow %&gt;% filter(broodyr &gt;= 1989) %&gt;% filter(flowstn == "SnakeBeFlat") %&gt;% select(broodyr, natq_winmean)) %&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(airtemp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(tempstn <span class="sc">==</span> <span class="st">"moose"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, temp_falmean, temp_winmean, temp_sprmean, temp_summean))</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(<span class="fu">cor</span>(p, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)[<span class="fu">upper.tri</span>(<span class="fu">cor</span>(p, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>))])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.5481930  0.5453191</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(p, <span class="at">progress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Experienced flow</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> jldramp <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_rampdur, jld_rampratemindoy, jld_rampratemin_log) <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_winvar, jld_summean)) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>          <span class="co">#left_join(natflow %&gt;% filter(flowstn == "SnakeNat") %&gt;% select(broodyr, natq_peakmag, natq_peaktime)) %&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeBeFlat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, natq_winmean, natq_peakmag, natq_peaktime)) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(airtemp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(tempstn <span class="sc">==</span> <span class="st">"moose"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, temp_falmean, temp_winmean, temp_sprmean, temp_summean)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>broodyr)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(<span class="fu">cor</span>(p, <span class="at">use =</span> <span class="st">"complete.obs"</span>)[<span class="fu">upper.tri</span>(<span class="fu">cor</span>(p, <span class="at">use =</span> <span class="st">"complete.obs"</span>))])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.5976980  0.6003041</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(p, <span class="at">progress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="test-specific-variables" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="test-specific-variables"><span class="header-section-number">3.2.2</span> Test specific variables</h3>
<section id="winter-flow" class="level4" data-number="3.2.2.1">
<h4 data-number="3.2.2.1" class="anchored" data-anchor-id="winter-flow"><span class="header-section-number">3.2.2.1</span> Winter flow</h4>
<p>JLD and natural winter flow highly correlated, especially after 1989</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_winmean) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, natq_winmean))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd<span class="sc">$</span>jld_winmean, ddd<span class="sc">$</span>natq_winmean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  ddd$jld_winmean and ddd$natq_winmean
t = 5.6337, df = 46, p-value = 1.022e-06
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.4335332 0.7812567
sample estimates:
      cor 
0.6389597 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ddd1 <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd1<span class="sc">$</span>jld_winmean, ddd1<span class="sc">$</span>natq_winmean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  ddd1$jld_winmean and ddd1$natq_winmean
t = 7.227, df = 32, p-value = 3.29e-08
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.6123541 0.8889125
sample estimates:
      cor 
0.7874557 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>ddd1 <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&lt;</span> <span class="dv">1989</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd1<span class="sc">$</span>jld_winmean, ddd1<span class="sc">$</span>natq_winmean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  ddd1$jld_winmean and ddd1$natq_winmean
t = 1.563, df = 12, p-value = 0.144
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.1526044  0.7731439
sample estimates:
      cor 
0.4112756 </code></pre>
</div>
</div>
</section>
<section id="peak-timing" class="level4" data-number="3.2.2.2">
<h4 data-number="3.2.2.2" class="anchored" data-anchor-id="peak-timing"><span class="header-section-number">3.2.2.2</span> Peak timing</h4>
<p>While the timing of peak natural vs.&nbsp;managed flows are not correlated during the full or either partial time period, this may be driven by years of missing data for JLD peak flows…where there was not a JLD peak. Time series plots are suspicious</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># peak timing...ok...</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_peaktime) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, natq_peaktime))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd<span class="sc">$</span>jld_peaktime, ddd<span class="sc">$</span>natq_peaktime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  ddd$jld_peaktime and ddd$natq_peaktime
t = -0.43671, df = 36, p-value = 0.6649
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.3833791  0.2529610
sample estimates:
        cor 
-0.07259273 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ddd<span class="sc">$</span>jld_peaktime, ddd<span class="sc">$</span>natq_peaktime, <span class="at">ylab =</span> <span class="st">"brood year DOY"</span>, <span class="at">xlab =</span> <span class="st">"year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(jld_peaktime <span class="sc">~</span> broodyr, ddd, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(natq_peaktime <span class="sc">~</span> broodyr, ddd, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"JLD"</span>, <span class="st">"natural"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>ddd1 <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd1<span class="sc">$</span>jld_peaktime, ddd1<span class="sc">$</span>natq_peaktime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  ddd1$jld_peaktime and ddd1$natq_peaktime
t = -0.62341, df = 23, p-value = 0.5392
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.4986378  0.2805140
sample estimates:
       cor 
-0.1289046 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(ddd1$jld_peaktime, ddd1$natq_peaktime)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#abline(a = 0, b = 1)</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>ddd1 <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&lt;</span> <span class="dv">1989</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd1<span class="sc">$</span>jld_peaktime, ddd1<span class="sc">$</span>natq_peaktime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  ddd1$jld_peaktime and ddd1$natq_peaktime
t = 0.013513, df = 11, p-value = 0.9895
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.5481414  0.5538164
sample estimates:
        cor 
0.004074438 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(ddd1$jld_peaktime, ddd1$natq_peaktime)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="peak-magnitude" class="level4" data-number="3.2.2.3">
<h4 data-number="3.2.2.3" class="anchored" data-anchor-id="peak-magnitude"><span class="header-section-number">3.2.2.3</span> Peak magnitude</h4>
<p>No multicollinearity issues between the magnitude of peak natural vs.&nbsp;managed flows, although these variables are somewhat correlated prior to 1989.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># peak magnitude...ok...</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_peakmag) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, natq_peakmag))</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd<span class="sc">$</span>jld_peakmag, ddd<span class="sc">$</span>natq_peakmag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  ddd$jld_peakmag and ddd$natq_peakmag
t = 4.9086, df = 46, p-value = 1.194e-05
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.3625576 0.7461337
sample estimates:
     cor 
0.586295 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(jld_peakmag <span class="sc">~</span> broodyr, ddd, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">3000</span>,<span class="dv">20000</span>))</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(natq_peakmag <span class="sc">~</span> broodyr, ddd, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"JLD"</span>, <span class="st">"natural"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>ddd1 <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd1<span class="sc">$</span>jld_peakmag, ddd1<span class="sc">$</span>natq_peakmag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  ddd1$jld_peakmag and ddd1$natq_peakmag
t = 3.6311, df = 32, p-value = 0.0009749
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.2471686 0.7426824
sample estimates:
      cor 
0.5401836 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>ddd1 <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&lt;</span> <span class="dv">1989</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd1<span class="sc">$</span>jld_peakmag, ddd1<span class="sc">$</span>natq_peakmag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  ddd1$jld_peakmag and ddd1$natq_peakmag
t = 3.2601, df = 12, p-value = 0.006828
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.2431875 0.8916793
sample estimates:
      cor 
0.6853377 </code></pre>
</div>
</div>
</section>
<section id="jld-peak-mag-and-jld-win-min" class="level4" data-number="3.2.2.4">
<h4 data-number="3.2.2.4" class="anchored" data-anchor-id="jld-peak-mag-and-jld-win-min"><span class="header-section-number">3.2.2.4</span> JLD peak mag and JLD win min</h4>
<p>JLD peak flow magnitude and combined winter mean flow are correlated (&gt;0.6)…perhaps an artifact of “good water years”</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_peakmag, jld_winmin)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd<span class="sc">$</span>jld_peakmag, ddd<span class="sc">$</span>jld_winmin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  ddd$jld_peakmag and ddd$jld_winmin
t = 2.2111, df = 61, p-value = 0.03079
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.02640982 0.48727185
sample estimates:
      cor 
0.2723925 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(jld_peakmag <span class="sc">~</span> broodyr, ddd, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(jld_winmin <span class="sc">~</span> broodyr, ddd, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"JLD peak mag"</span>, <span class="st">"Combined winter mean"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="JoinFishDataWithCovariates_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>ddd1 <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd1<span class="sc">$</span>jld_peakmag, ddd1<span class="sc">$</span>jld_winmin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  ddd1$jld_peakmag and ddd1$jld_winmin
t = 2.4703, df = 32, p-value = 0.01902
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.07173556 0.65034644
sample estimates:
      cor 
0.4001932 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>ddd1 <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&lt;</span> <span class="dv">1989</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd1<span class="sc">$</span>jld_peakmag, ddd1<span class="sc">$</span>jld_winmin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  ddd1$jld_peakmag and ddd1$jld_winmin
t = 1.9257, df = 27, p-value = 0.06473
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.02176591  0.63335086
sample estimates:
     cor 
0.347512 </code></pre>
</div>
</div>
</section>
</section>
<section id="lag-correlations" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="lag-correlations"><span class="header-section-number">3.2.3</span> Lag correlations</h3>
<p>Check correlations between variables in year t and t+1 (to separate age-0 and age-1 effects).</p>
<p>Winter variation is the only variable that is moderately correlated between time <em>t</em> and <em>t+1</em> (0.65)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(jldramp<span class="sc">$</span>jld_rampdur, <span class="fu">lead</span>(jldramp<span class="sc">$</span>jld_rampdur))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  jldramp$jld_rampdur and lead(jldramp$jld_rampdur)
t = 0.96669, df = 60, p-value = 0.3376
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.1299488  0.3623978
sample estimates:
      cor 
0.1238389 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(jldramp<span class="sc">$</span>jld_rampratemindoy, <span class="fu">lead</span>(jldramp<span class="sc">$</span>jld_rampratemindoy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  jldramp$jld_rampratemindoy and lead(jldramp$jld_rampratemindoy)
t = 4.2439, df = 60, p-value = 7.735e-05
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.2621889 0.6520108
sample estimates:
      cor 
0.4804914 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(jldramp<span class="sc">$</span>jld_rampratemin_log, <span class="fu">lead</span>(jldramp<span class="sc">$</span>jld_rampratemin_log))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  jldramp$jld_rampratemin_log and lead(jldramp$jld_rampratemin_log)
t = 0.70935, df = 60, p-value = 0.4809
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.1622692  0.3333699
sample estimates:
       cor 
0.09119508 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(jldflow<span class="sc">$</span>jld_winmin, <span class="fu">lead</span>(jldflow<span class="sc">$</span>jld_winmin))                  <span class="co"># pearsons r = 0.65</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  jldflow$jld_winmin and lead(jldflow$jld_winmin)
t = 4.3865, df = 60, p-value = 4.729e-05
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.2771030 0.6611604
sample estimates:
      cor 
0.4927661 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(jldflow<span class="sc">$</span>jld_summean, <span class="fu">lead</span>(jldflow<span class="sc">$</span>jld_summean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  jldflow$jld_summean and lead(jldflow$jld_summean)
t = 0.27338, df = 60, p-value = 0.7855
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.2164039  0.2825498
sample estimates:
       cor 
0.03527073 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(jldflow<span class="sc">$</span>jld_peakmag, <span class="fu">lead</span>(jldflow<span class="sc">$</span>jld_peakmag))                  <span class="co"># pearsons r = 0.65</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  jldflow$jld_peakmag and lead(jldflow$jld_peakmag)
t = 2.5116, df = 60, p-value = 0.01473
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.06357118 0.51828219
sample estimates:
      cor 
0.3084419 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(jldflow<span class="sc">$</span>jld_peaktime, <span class="fu">lead</span>(jldflow<span class="sc">$</span>jld_peaktime))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  jldflow$jld_peaktime and lead(jldflow$jld_peaktime)
t = 1.0467, df = 44, p-value = 0.3009
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.1407981  0.4268542
sample estimates:
      cor 
0.1558709 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(d<span class="sc">$</span>natq_peakmag, <span class="fu">lead</span>(d<span class="sc">$</span>natq_peakmag))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  d$natq_peakmag and lead(d$natq_peakmag)
t = 0.17576, df = 45, p-value = 0.8613
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.2629533  0.3110188
sample estimates:
       cor 
0.02619124 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(d<span class="sc">$</span>natq_peaktime, <span class="fu">lead</span>(d<span class="sc">$</span>natq_peaktime))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  d$natq_peaktime and lead(d$natq_peaktime)
t = 0.85953, df = 45, p-value = 0.3946
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.1661387  0.3996718
sample estimates:
      cor 
0.1270916 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> airtemp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(tempstn <span class="sc">==</span> <span class="st">"moose"</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(d<span class="sc">$</span>temp_falmean, <span class="fu">lead</span>(d<span class="sc">$</span>temp_falmean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  d$temp_falmean and lead(d$temp_falmean)
t = 2.5647, df = 56, p-value = 0.01303
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.07193934 0.53749544
sample estimates:
      cor 
0.3242108 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(d<span class="sc">$</span>temp_winmean, <span class="fu">lead</span>(d<span class="sc">$</span>temp_winmean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  d$temp_winmean and lead(d$temp_winmean)
t = 0.82595, df = 58, p-value = 0.4122
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.1502169  0.3521051
sample estimates:
      cor 
0.1078205 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(d<span class="sc">$</span>temp_sprmean, <span class="fu">lead</span>(d<span class="sc">$</span>temp_sprmean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  d$temp_sprmean and lead(d$temp_sprmean)
t = 0.96896, df = 52, p-value = 0.337
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.1395630  0.3871302
sample estimates:
      cor 
0.1331742 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(d<span class="sc">$</span>temp_summean, <span class="fu">lead</span>(d<span class="sc">$</span>temp_summean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  d$temp_summean and lead(d$temp_summean)
t = 1.3246, df = 53, p-value = 0.191
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.09059664  0.42415727
sample estimates:
      cor 
0.1790029 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlations among natural, managed, and combined winter flow</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_annmin) <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, natq_annmin)) <span class="sc">%&gt;%</span> </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeBeFlat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, natq_annmin) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">expq_annmin =</span> natq_annmin)) </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(ddd)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>))</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_peakmag) <span class="sc">%&gt;%</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, natq_peakmag)) <span class="sc">%&gt;%</span> </span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeBeFlat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, natq_peakmag) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">expq_peakmag =</span> natq_peakmag)) </span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(ddd)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>))</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_peaktime) <span class="sc">%&gt;%</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, natq_peaktime)) <span class="sc">%&gt;%</span> </span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeBeFlat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, natq_peaktime) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">expq_peaktime =</span> natq_peaktime)) </span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(ddd)</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>))</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a><span class="co"># winter flow time series plots</span></span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_annmin) <span class="sc">%&gt;%</span> </span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, natq_annmin)) <span class="sc">%&gt;%</span> </span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tot_annmin =</span> jld_annmin <span class="sc">+</span> natq_annmin,</span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">prop_annmin =</span> jld_annmin<span class="sc">/</span>tot_annmin) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(tot_annmin))</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>ddd<span class="sc">$</span>cor <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a>ddd<span class="sc">$</span>cor[<span class="dv">5</span><span class="sc">:</span><span class="dv">44</span>] <span class="ot">&lt;-</span> <span class="fu">rollapply</span>(ddd, <span class="at">width =</span> <span class="dv">9</span>, <span class="cf">function</span>(x) <span class="fu">abs</span>(<span class="fu">cor</span>(x[,<span class="dv">2</span>], x[,<span class="dv">3</span>])), <span class="at">by.column =</span> <span class="cn">FALSE</span>)</span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.5</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tot_annmin <span class="sc">~</span> broodyr, ddd, <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2500</span>), <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Winter flow (cfs)"</span>, <span class="at">bty =</span> <span class="st">"l"</span>)</span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(ddd<span class="sc">$</span>broodyr, <span class="fu">rev</span>(ddd<span class="sc">$</span>broodyr)), <span class="at">y =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="at">times =</span> <span class="fu">dim</span>(ddd)[<span class="dv">1</span>]), <span class="fu">rev</span>(ddd<span class="sc">$</span>tot_annmin)), <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb85-32"><a href="#cb85-32" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(ddd<span class="sc">$</span>broodyr, <span class="fu">rev</span>(ddd<span class="sc">$</span>broodyr)), <span class="at">y =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="at">times =</span> <span class="fu">dim</span>(ddd)[<span class="dv">1</span>]), <span class="fu">rev</span>(ddd<span class="sc">$</span>natq_annmin)), <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb85-33"><a href="#cb85-33" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(ddd<span class="sc">$</span>broodyr, <span class="fu">rev</span>(ddd<span class="sc">$</span>broodyr)), <span class="at">y =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="at">times =</span> <span class="fu">dim</span>(ddd)[<span class="dv">1</span>]), <span class="fu">rev</span>(ddd<span class="sc">$</span>jld_annmin)), <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb85-34"><a href="#cb85-34" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(ddd<span class="sc">$</span>broodyr, <span class="fu">rev</span>(ddd<span class="sc">$</span>broodyr)), <span class="at">y =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="at">times =</span> <span class="fu">dim</span>(ddd)[<span class="dv">1</span>]), <span class="fu">rev</span>(ddd<span class="sc">$</span>natq_annmin)), <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">col =</span> scales<span class="sc">::</span><span class="fu">alpha</span>(<span class="st">"darkorchid2"</span>, <span class="dv">1</span>))</span>
<span id="cb85-35"><a href="#cb85-35" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(ddd<span class="sc">$</span>broodyr, <span class="fu">rev</span>(ddd<span class="sc">$</span>broodyr)), <span class="at">y =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="at">times =</span> <span class="fu">dim</span>(ddd)[<span class="dv">1</span>]), <span class="fu">rev</span>(ddd<span class="sc">$</span>jld_annmin)), <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">col =</span> scales<span class="sc">::</span><span class="fu">alpha</span>(<span class="st">"goldenrod1"</span>, <span class="dv">1</span>))</span>
<span id="cb85-36"><a href="#cb85-36" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Total"</span>, <span class="st">"Natural"</span>, <span class="st">"Managed"</span>), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"grey"</span>, <span class="st">"darkorchid2"</span>, <span class="st">"goldenrod1"</span>), <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb85-37"><a href="#cb85-37" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prop_annmin <span class="sc">~</span> broodyr, ddd, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">bty =</span> <span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"JLD contribution to winter flow"</span>)</span>
<span id="cb85-38"><a href="#cb85-38" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(prop_annmin <span class="sc">~</span> broodyr, ddd, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb85-39"><a href="#cb85-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cor <span class="sc">~</span> broodyr, ddd, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">bty =</span> <span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Correlation (rolling 9-year window)"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb85-40"><a href="#cb85-40" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(cor <span class="sc">~</span> broodyr, ddd, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb85-41"><a href="#cb85-41" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.6</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="select-covariates-and-standardize" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="select-covariates-and-standardize"><span class="header-section-number">3.3</span> Select Covariates and Standardize</h2>
<p>Pull out relevant variables, trim to temporal extent of redd count data (by brood year. I.e., redd counts start at 1971 but environmental data starts at 1967), and standardize (mean centered and scaled).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Managed flow variables</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>covsrc_jldq <span class="ot">&lt;-</span> jldramp <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_rampdur, jld_rampratemindoy, jld_rampratemin_log) <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> minby) <span class="sc">%&gt;%</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_winmean, jld_winmin, jld_winvar, jld_summean, jld_peakmag, jld_peaktime)) <span class="sc">%&gt;%</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(jld_winmin_log = ifelse(jld_winmin_log &lt; 4, NA, jld_winmin_log)) %&gt;%</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_jld_rampdur =</span> <span class="fu">scale</span>(jld_rampdur, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_rampratemindoy =</span> <span class="fu">scale</span>(jld_rampratemindoy, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_rampratemin_log =</span> <span class="fu">scale</span>(jld_rampratemin_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>],</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_winmean =</span> <span class="fu">scale</span>(jld_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>],</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_winmin =</span> <span class="fu">scale</span>(jld_winmin, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>],</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_winvar =</span> <span class="fu">scale</span>(jld_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>],</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_summean =</span> <span class="fu">scale</span>(jld_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>],</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_peakmag =</span> <span class="fu">scale</span>(jld_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>],</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_peaktime =</span> <span class="fu">scale</span>(jld_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>])</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co">#ggpairs(covsrc_jldq %&gt;% select(broodyr, jld_rampdur, jld_rampratemindoy, jld_rampratemin_log, jld_winmean, jld_winmin, jld_winvar, jld_summean, jld_peakmag, jld_peaktime))</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Managed flow variables - ramp-down only</span></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>covsrc_jldq_rd <span class="ot">&lt;-</span> jldramp <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_rampdur, jld_rampratemindoy, jld_rampratemin_log) <span class="sc">%&gt;%</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> minby) <span class="sc">%&gt;%</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(jld_rampratemin = ifelse(jld_rampratemin &lt; -2000, NA, jld_rampratemin)) %&gt;%</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_jld_rampdur =</span> <span class="fu">scale</span>(jld_rampdur, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_rampratemindoy =</span> <span class="fu">scale</span>(jld_rampratemindoy, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_rampratemin_log =</span> <span class="fu">scale</span>(jld_rampratemin_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>])</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a><span class="co">#ggpairs(covsrc_jldq_rd %&gt;% select(broodyr, jld_rampdur, jld_rampratemindoy, jld_rampratemin_log))</span></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Natural/wild flow variables </span></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>covsrc_natq <span class="ot">&lt;-</span> natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SnakeNat"</span>)) <span class="sc">%&gt;%</span> <span class="co"># make sure flow station is correct!</span></span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(flowstn, broodyr, natq_falmean_log, natq_winmean_log, natq_sprmean_log, natq_summean_log, natq_winvar, natq_peakmag, natq_peaktime) <span class="sc">%&gt;%</span> <span class="co">#rename(flowstn = site) %&gt;% </span></span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> minby) <span class="sc">%&gt;%</span></span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_natq_winvar =</span> <span class="fu">scale</span>(natq_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_natq_falmean_log =</span> <span class="fu">scale</span>(natq_falmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_winmean_log =</span> <span class="fu">scale</span>(natq_winmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_sprmean_log =</span> <span class="fu">scale</span>(natq_sprmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_summean_log =</span> <span class="fu">scale</span>(natq_summean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_peakmag =</span> <span class="fu">scale</span>(natq_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_peaktime =</span> <span class="fu">scale</span>(natq_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a><span class="co">#ggpairs(covsrc_natq %&gt;% select(broodyr, natq_falmean_log, natq_winmean_log, natq_sprmean_log, natq_summean_log, natq_winvar, natq_peakmag, natq_peaktime))</span></span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Experienced flow variables</span></span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a>covsrc_expq <span class="ot">&lt;-</span> natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SnakeBeFlat"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(flowstn, broodyr, natq_winmean, natq_winvar, natq_summean, natq_peakmag, natq_peaktime) <span class="sc">%&gt;%</span></span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> minby) <span class="sc">%&gt;%</span></span>
<span id="cb86-43"><a href="#cb86-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_natq_winmean =</span> <span class="fu">scale</span>(natq_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb86-44"><a href="#cb86-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_winvar =</span> <span class="fu">scale</span>(natq_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb86-45"><a href="#cb86-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_summean =</span> <span class="fu">scale</span>(natq_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb86-46"><a href="#cb86-46" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_peakmag =</span> <span class="fu">scale</span>(natq_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb86-47"><a href="#cb86-47" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_peaktime =</span> <span class="fu">scale</span>(natq_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>])</span>
<span id="cb86-48"><a href="#cb86-48" aria-hidden="true" tabindex="-1"></a><span class="co">#ggpairs(covsrc_expq %&gt;% select(broodyr, natq_winmean, natq_winvar, natq_summean, natq_peakmag, natq_peaktime))</span></span>
<span id="cb86-49"><a href="#cb86-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-50"><a href="#cb86-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperature variables</span></span>
<span id="cb86-51"><a href="#cb86-51" aria-hidden="true" tabindex="-1"></a>covsrc_temp <span class="ot">&lt;-</span> airtemp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(tempstn <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"moose"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-52"><a href="#cb86-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(tempstn, broodyr, temp_falmean, temp_winmean, temp_sprmean, temp_summean) <span class="sc">%&gt;%</span> <span class="co">#rename(tempstn = site) %&gt;% #group_by(tempstn) %&gt;%</span></span>
<span id="cb86-53"><a href="#cb86-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> minby) <span class="sc">%&gt;%</span></span>
<span id="cb86-54"><a href="#cb86-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_temp_falmean =</span> <span class="fu">scale</span>(temp_falmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb86-55"><a href="#cb86-55" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_temp_winmean =</span> <span class="fu">scale</span>(temp_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb86-56"><a href="#cb86-56" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_temp_sprmean =</span> <span class="fu">scale</span>(temp_sprmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb86-57"><a href="#cb86-57" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_temp_summean =</span> <span class="fu">scale</span>(temp_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb86-58"><a href="#cb86-58" aria-hidden="true" tabindex="-1"></a><span class="co">#ggpairs(covsrc_temp %&gt;% select(broodyr, temp_falmean, temp_winmean, temp_sprmean, temp_summean))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Create and write out summary tables (means and standard deviations)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># JLD Flow</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>covsrc_jldq_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">cov =</span> <span class="fu">c</span>(<span class="st">"z_jld_rampdur"</span>, <span class="st">"z_jld_rampratemindoy"</span>, <span class="st">"z_jld_rampratemin_log"</span>, <span class="st">"z_jld_winmean"</span>, <span class="st">"z_jld_winmin"</span>, <span class="st">"z_jld_winvar"</span>, <span class="st">"z_jld_summean"</span>, <span class="st">"z_jld_peakmag"</span>, <span class="st">"z_jld_peaktime"</span>),</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mean =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_rampdur, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_rampratemindoy, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_rampratemin_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_winmin, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>)),</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_rampdur, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_rampratemindoy, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_rampratemin_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_winmin, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>)))</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(covsrc_jldq_summary, <span class="st">"Data/Derived/ManagedFlow_SummaryMeanSD_1967-2022.csv"</span>)</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Natural Flow</span></span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>covsrc_natq_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">cov =</span> <span class="fu">c</span>(<span class="st">"z_natq_falmean_log"</span>, <span class="st">"z_natq_winmean_log"</span>, <span class="st">"z_natq_sprmean_log"</span>, <span class="st">"z_natq_summean_log"</span>, <span class="st">"z_natq_winvar"</span>, <span class="st">"z_natq_peakmag"</span>, <span class="st">"z_natq_peaktime"</span>),</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mean =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_falmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_winmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_sprmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_summean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>)),</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_falmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_winmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_sprmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_summean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>)))</span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(covsrc_natq_summary, <span class="st">"Data/Derived/NaturalFlow_SummaryMeanSD_1975-2022.csv"</span>)</span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Experienced Flow</span></span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a>covsrc_expq_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">cov =</span> <span class="fu">c</span>(<span class="st">"z_expq_winmean"</span>, <span class="st">"z_expq_winvar"</span>, <span class="st">"z_expq_summean"</span>, <span class="st">"z_expq_peakmag"</span>, <span class="st">"z_expq_peaktime"</span>),</span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mean =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-46"><a href="#cb87-46" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-47"><a href="#cb87-47" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>)),</span>
<span id="cb87-48"><a href="#cb87-48" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-49"><a href="#cb87-49" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-50"><a href="#cb87-50" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-51"><a href="#cb87-51" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-52"><a href="#cb87-52" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>)))</span>
<span id="cb87-53"><a href="#cb87-53" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(covsrc_expq_summary, <span class="st">"Data/Derived/ExperiencedFlow_SummaryMeanSD_1975-2022.csv"</span>)</span>
<span id="cb87-54"><a href="#cb87-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-55"><a href="#cb87-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperature</span></span>
<span id="cb87-56"><a href="#cb87-56" aria-hidden="true" tabindex="-1"></a>covsrc_temp_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">cov =</span> <span class="fu">c</span>(<span class="st">"z_temp_falmean"</span>, <span class="st">"z_temp_winmean"</span>, <span class="st">"z_temp_sprmean"</span>, <span class="st">"z_temp_summean"</span>),</span>
<span id="cb87-57"><a href="#cb87-57" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mean =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_temp<span class="sc">$</span>temp_falmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-58"><a href="#cb87-58" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_temp<span class="sc">$</span>temp_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-59"><a href="#cb87-59" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_temp<span class="sc">$</span>temp_sprmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb87-60"><a href="#cb87-60" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_temp<span class="sc">$</span>temp_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>)),</span>
<span id="cb87-61"><a href="#cb87-61" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_temp<span class="sc">$</span>temp_falmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-62"><a href="#cb87-62" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_temp<span class="sc">$</span>temp_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-63"><a href="#cb87-63" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_temp<span class="sc">$</span>temp_sprmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb87-64"><a href="#cb87-64" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_temp<span class="sc">$</span>temp_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>)))</span>
<span id="cb87-65"><a href="#cb87-65" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(covsrc_temp_summary, <span class="st">"Data/Derived/Temperature_SummaryMeanSD_1967-2022.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="join-covariate-and-fish-data" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="join-covariate-and-fish-data"><span class="header-section-number">3.4</span> Join Covariate and Fish Data</h2>
<section id="separate-natural-and-managed-flow-components" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="separate-natural-and-managed-flow-components"><span class="header-section-number">3.4.1</span> Separate natural and managed flow components</h3>
<p>Age-0 (4-year lag)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>redds3a <span class="ot">&lt;-</span> redds2</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>redds3a<span class="sc">$</span>broodyr <span class="ot">&lt;-</span> redds3a<span class="sc">$</span>year <span class="sc">-</span> <span class="dv">4</span> <span class="co"># create broodyr variable for joining</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>redds3a<span class="sc">$</span>tempstn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(redds3a<span class="sc">$</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>), <span class="st">"afton"</span>, <span class="st">"moose"</span>) <span class="co"># basin ID to match to NWS temp station</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>redds3a<span class="sc">$</span>flowstn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(redds3a<span class="sc">$</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>), <span class="st">"Salt"</span>, <span class="st">"SnakeNat"</span>) <span class="co"># basin ID to match to USGS flow station </span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>redds3a <span class="ot">&lt;-</span> redds3a <span class="sc">%&gt;%</span> </span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_jldq, <span class="at">by =</span> <span class="st">"broodyr"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_natq, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"broodyr"</span>, <span class="st">"flowstn"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_temp, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"broodyr"</span>, <span class="st">"tempstn"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Age-1 (3-year lag)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>redds3b <span class="ot">&lt;-</span> redds2</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>redds3b<span class="sc">$</span>broodyr <span class="ot">&lt;-</span> redds3b<span class="sc">$</span>year <span class="sc">-</span> <span class="dv">3</span> <span class="co"># create broodyr variable for joining</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>redds3b<span class="sc">$</span>tempstn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(redds3b<span class="sc">$</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>), <span class="st">"afton"</span>, <span class="st">"moose"</span>) <span class="co"># basin ID to match to NWS temp station</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>redds3b<span class="sc">$</span>flowstn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(redds3b<span class="sc">$</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>), <span class="st">"Salt"</span>, <span class="st">"SnakeNat"</span>) <span class="co"># basin ID to match to USGS flow station </span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>redds3b <span class="ot">&lt;-</span> redds3b <span class="sc">%&gt;%</span> </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_jldq, <span class="at">by =</span> <span class="st">"broodyr"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_natq, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"broodyr"</span>, <span class="st">"flowstn"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_temp, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"broodyr"</span>, <span class="st">"tempstn"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="experienced-flow" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="experienced-flow"><span class="header-section-number">3.4.2</span> Experienced flow</h3>
<p>Age-0 (4-year lag)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>redds3c <span class="ot">&lt;-</span> redds2</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>redds3c<span class="sc">$</span>broodyr <span class="ot">&lt;-</span> redds3c<span class="sc">$</span>year <span class="sc">-</span> <span class="dv">4</span> <span class="co"># create broodyr variable for joining</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>redds3c<span class="sc">$</span>tempstn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(redds3c<span class="sc">$</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>), <span class="st">"afton"</span>, <span class="st">"moose"</span>) <span class="co"># basin ID to match to NWS temp station</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>redds3c<span class="sc">$</span>flowstn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(redds3c<span class="sc">$</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>), <span class="st">"Salt"</span>, <span class="st">"SnakeBeFlat"</span>) <span class="co"># basin ID to match to USGS flow station </span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>redds3c <span class="ot">&lt;-</span> redds3c <span class="sc">%&gt;%</span> </span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_jldq_rd, <span class="at">by =</span> <span class="st">"broodyr"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_expq, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"broodyr"</span>, <span class="st">"flowstn"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_temp, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"broodyr"</span>, <span class="st">"tempstn"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Age-1 (3-year lag)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>redds3d <span class="ot">&lt;-</span> redds2</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>redds3d<span class="sc">$</span>broodyr <span class="ot">&lt;-</span> redds3d<span class="sc">$</span>year <span class="sc">-</span> <span class="dv">3</span> <span class="co"># create broodyr variable for joining</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>redds3d<span class="sc">$</span>tempstn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(redds3d<span class="sc">$</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>), <span class="st">"afton"</span>, <span class="st">"moose"</span>) <span class="co"># basin ID to match to NWS temp station</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>redds3d<span class="sc">$</span>flowstn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(redds3d<span class="sc">$</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>), <span class="st">"Salt"</span>, <span class="st">"SnakeBeFlat"</span>) <span class="co"># basin ID to match to USGS flow station </span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>redds3d <span class="ot">&lt;-</span> redds3d <span class="sc">%&gt;%</span> </span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_jldq_rd, <span class="at">by =</span> <span class="st">"broodyr"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_expq, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"broodyr"</span>, <span class="st">"flowstn"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_temp, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"broodyr"</span>, <span class="st">"tempstn"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="write-out-data-files" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="write-out-data-files"><span class="header-section-number">3.4.3</span> Write out data files</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(redds3a, <span class="st">"Data/Derived/ReddCounts_WGFD_1971-2021_cleaned_withFlowTempCovariates_SeparateFlowComponents_age0.csv"</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(redds3b, <span class="st">"Data/Derived/ReddCounts_WGFD_1971-2021_cleaned_withFlowTempCovariates_SeparateFlowComponents_age1.csv"</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(redds3c, <span class="st">"Data/Derived/ReddCounts_WGFD_1971-2021_cleaned_withFlowTempCovariates_ExperiencedFlow_age0.csv"</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(redds3d, <span class="st">"Data/Derived/ReddCounts_WGFD_1971-2021_cleaned_withFlowTempCovariates_ExperiencedFlow_age1.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(natq_winmean <span class="sc">~</span> broodyr, covsrc_expq, <span class="at">type =</span> <span class="st">"b"</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(natq_winvar <span class="sc">~</span> broodyr, covsrc_expq, <span class="at">type =</span> <span class="st">"b"</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(natq_peakmag <span class="sc">~</span> broodyr, covsrc_expq, <span class="at">type =</span> <span class="st">"b"</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(natq_peaktime <span class="sc">~</span> broodyr, covsrc_expq, <span class="at">type =</span> <span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./FlowTemp_Covariates.html" class="pagination-link" aria-label="Environmental Covariates">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Environmental Covariates</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ReddCountsRicker.html" class="pagination-link" aria-label="Stock-Recruitment Analysis">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Stock-Recruitment Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb94" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Join Fish and Env. Data"</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>Purpose: join redd count and environmental covariate data and explore correlations between key environmental variables.</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="in">library(sf)</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="in">library(mapview)</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="in">library(RColorBrewer)</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="in">library(GGally)</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="in">library(zoo)</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a><span class="fu">## Redd Count Data</span></span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>Load YCT redd count data and plot time series</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=8, fig.height=6}</span></span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a><span class="in">redds &lt;- read_csv("Data/ReddCounts_WGFD_1971-2021_cleaned.csv") %&gt;% </span></span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(!stream %in% c("Cody", "Christiansen", "Dave", "Laker")) # drop Cody (too few data points) and Salt River tribs</span></span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a><span class="in">redds %&gt;% ggplot() + geom_point(aes(x = year, y = reddspermile)) + geom_line(aes(x = year, y = reddspermile)) + facet_wrap(~ stream, scales = "free_y") + theme_bw() + theme(panel.grid = element_blank())</span></span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>Map sites:</span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a>reddlocs <span class="ot">&lt;-</span> redds <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(stream) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">lat =</span> <span class="fu">unique</span>(lat), <span class="at">long =</span> <span class="fu">unique</span>(long)) <span class="co"># summarize location data</span></span>
<span id="cb94-32"><a href="#cb94-32" aria-hidden="true" tabindex="-1"></a>reddlocs_sp <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(reddlocs, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"long"</span>, <span class="st">"lat"</span>), <span class="at">crs =</span> <span class="st">"+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84"</span>)</span>
<span id="cb94-33"><a href="#cb94-33" aria-hidden="true" tabindex="-1"></a><span class="co"># st_write(reddlocs_sp, "Redd Counts Ricker/Spatial/ReddCounts_SpatialLocations.shp", append = FALSE)</span></span>
<span id="cb94-34"><a href="#cb94-34" aria-hidden="true" tabindex="-1"></a><span class="fu">mapview</span>(reddlocs_sp) <span class="co"># map</span></span>
<span id="cb94-35"><a href="#cb94-35" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-36"><a href="#cb94-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-37"><a href="#cb94-37" aria-hidden="true" tabindex="-1"></a>Explore autocorrelation, which may be due to stock-recruit dynamics, autocorrelated environmental drivers, or both</span>
<span id="cb94-38"><a href="#cb94-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=8, fig.height=6}</span></span>
<span id="cb94-39"><a href="#cb94-39" aria-hidden="true" tabindex="-1"></a><span class="in">sites &lt;- unique(redds$stream)</span></span>
<span id="cb94-40"><a href="#cb94-40" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(4,4), mgp = c(2.5,1,0), mar = c(3.5,3.5,1,1))</span></span>
<span id="cb94-41"><a href="#cb94-41" aria-hidden="true" tabindex="-1"></a><span class="in">for (i in 1:length(sites)) {</span></span>
<span id="cb94-42"><a href="#cb94-42" aria-hidden="true" tabindex="-1"></a><span class="in">  d &lt;- filter(redds, stream == sites[i])</span></span>
<span id="cb94-43"><a href="#cb94-43" aria-hidden="true" tabindex="-1"></a><span class="in">  acf(d$reddsperkm, lag.max = 6, plot = TRUE, na.action = na.pass)</span></span>
<span id="cb94-44"><a href="#cb94-44" aria-hidden="true" tabindex="-1"></a><span class="in">  legend("topright", legend = sites[i], bty = "n")</span></span>
<span id="cb94-45"><a href="#cb94-45" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb94-46"><a href="#cb94-46" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-47"><a href="#cb94-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-48"><a href="#cb94-48" aria-hidden="true" tabindex="-1"></a>For each site, add years in which data was not collected, then calculate lagged redds</span>
<span id="cb94-51"><a href="#cb94-51" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-52"><a href="#cb94-52" aria-hidden="true" tabindex="-1"></a>lagg <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb94-53"><a href="#cb94-53" aria-hidden="true" tabindex="-1"></a>rlist <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb94-54"><a href="#cb94-54" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">unique</span>(redds<span class="sc">$</span>stream)</span>
<span id="cb94-55"><a href="#cb94-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sites)) {</span>
<span id="cb94-56"><a href="#cb94-56" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">filter</span>(redds, stream <span class="sc">==</span> sites[i])</span>
<span id="cb94-57"><a href="#cb94-57" aria-hidden="true" tabindex="-1"></a>  df1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">year =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(d<span class="sc">$</span>year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">to =</span> <span class="fu">max</span>(d<span class="sc">$</span>year, <span class="at">na.rm =</span> T), <span class="at">by =</span> <span class="dv">1</span>))</span>
<span id="cb94-58"><a href="#cb94-58" aria-hidden="true" tabindex="-1"></a>  rlist[[i]] <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(d) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stream =</span> sites[i], </span>
<span id="cb94-59"><a href="#cb94-59" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">miles =</span> <span class="fu">unique</span>(d<span class="sc">$</span>miles), </span>
<span id="cb94-60"><a href="#cb94-60" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">kms =</span> <span class="fu">unique</span>(d<span class="sc">$</span>kms), </span>
<span id="cb94-61"><a href="#cb94-61" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">lat =</span> <span class="fu">unique</span>(d<span class="sc">$</span>lat), </span>
<span id="cb94-62"><a href="#cb94-62" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">long =</span> <span class="fu">unique</span>(d<span class="sc">$</span>long),</span>
<span id="cb94-63"><a href="#cb94-63" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">reddsperkm_lag4 =</span> <span class="fu">lag</span>(reddsperkm, <span class="at">n =</span> lagg))</span>
<span id="cb94-64"><a href="#cb94-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-65"><a href="#cb94-65" aria-hidden="true" tabindex="-1"></a>redds2 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(rlist)</span>
<span id="cb94-66"><a href="#cb94-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-67"><a href="#cb94-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-68"><a href="#cb94-68" aria-hidden="true" tabindex="-1"></a>Explore the effect of spawners on productivity to motivate use of Ricker model, *sensu* Jones *et al.* (2020).</span>
<span id="cb94-69"><a href="#cb94-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  fig.width=8, fig.height=6}</span></span>
<span id="cb94-70"><a href="#cb94-70" aria-hidden="true" tabindex="-1"></a><span class="in"># recruits ~ spawners, combined</span></span>
<span id="cb94-71"><a href="#cb94-71" aria-hidden="true" tabindex="-1"></a><span class="in"># redds2 %&gt;% ggplot(aes(x = reddsperkm_lag4, y = reddsperkm)) +</span></span>
<span id="cb94-72"><a href="#cb94-72" aria-hidden="true" tabindex="-1"></a><span class="in">#   geom_point(aes(colour = stream)) +</span></span>
<span id="cb94-73"><a href="#cb94-73" aria-hidden="true" tabindex="-1"></a><span class="in">#   geom_smooth(method = "loess")</span></span>
<span id="cb94-74"><a href="#cb94-74" aria-hidden="true" tabindex="-1"></a><span class="in"># recruits ~ spawners, by stream</span></span>
<span id="cb94-75"><a href="#cb94-75" aria-hidden="true" tabindex="-1"></a><span class="in"># redds2 %&gt;% ggplot(aes(x = reddsperkm_lag4, y = reddsperkm)) + </span></span>
<span id="cb94-76"><a href="#cb94-76" aria-hidden="true" tabindex="-1"></a><span class="in">#   geom_point(aes(colour = year)) + </span></span>
<span id="cb94-77"><a href="#cb94-77" aria-hidden="true" tabindex="-1"></a><span class="in">#   geom_smooth() +</span></span>
<span id="cb94-78"><a href="#cb94-78" aria-hidden="true" tabindex="-1"></a><span class="in">#   facet_wrap(~stream, scales = "free")</span></span>
<span id="cb94-79"><a href="#cb94-79" aria-hidden="true" tabindex="-1"></a><span class="in"># # productivity ~ time, by stream</span></span>
<span id="cb94-80"><a href="#cb94-80" aria-hidden="true" tabindex="-1"></a><span class="in"># redds2 %&gt;% ggplot(aes(x = year, y = log(reddsperkm/reddsperkm_lag4))) + </span></span>
<span id="cb94-81"><a href="#cb94-81" aria-hidden="true" tabindex="-1"></a><span class="in">#   geom_point(aes(colour = year)) + </span></span>
<span id="cb94-82"><a href="#cb94-82" aria-hidden="true" tabindex="-1"></a><span class="in">#   geom_smooth() +</span></span>
<span id="cb94-83"><a href="#cb94-83" aria-hidden="true" tabindex="-1"></a><span class="in">#   facet_wrap(~stream, scales = "free_y")</span></span>
<span id="cb94-84"><a href="#cb94-84" aria-hidden="true" tabindex="-1"></a><span class="in"># productivity ~ spawning stock, combined</span></span>
<span id="cb94-85"><a href="#cb94-85" aria-hidden="true" tabindex="-1"></a><span class="in"># redds2 %&gt;% ggplot(aes(x = reddsperkm_lag4, y = log(reddsperkm/reddsperkm_lag4))) + </span></span>
<span id="cb94-86"><a href="#cb94-86" aria-hidden="true" tabindex="-1"></a><span class="in">#   geom_smooth(method = "lm") +</span></span>
<span id="cb94-87"><a href="#cb94-87" aria-hidden="true" tabindex="-1"></a><span class="in">#   geom_point(aes(colour = stream))</span></span>
<span id="cb94-88"><a href="#cb94-88" aria-hidden="true" tabindex="-1"></a><span class="in"># productivity ~ spawning stock, by stream</span></span>
<span id="cb94-89"><a href="#cb94-89" aria-hidden="true" tabindex="-1"></a><span class="in">redds2 %&gt;% ggplot(aes(x = reddsperkm_lag4, y = log(reddsperkm/reddsperkm_lag4), colour = year)) + </span></span>
<span id="cb94-90"><a href="#cb94-90" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_smooth(method = "lm") +</span></span>
<span id="cb94-91"><a href="#cb94-91" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(aes(colour = year)) + </span></span>
<span id="cb94-92"><a href="#cb94-92" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~stream, scales = "free")</span></span>
<span id="cb94-93"><a href="#cb94-93" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-94"><a href="#cb94-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-95"><a href="#cb94-95" aria-hidden="true" tabindex="-1"></a>Get range of years by site</span>
<span id="cb94-98"><a href="#cb94-98" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-99"><a href="#cb94-99" aria-hidden="true" tabindex="-1"></a>redds2 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(stream) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">start =</span> <span class="fu">min</span>(year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">stop =</span> <span class="fu">max</span>(year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb94-100"><a href="#cb94-100" aria-hidden="true" tabindex="-1"></a>minby <span class="ot">&lt;-</span> <span class="fu">min</span>(redds2<span class="sc">$</span>year) <span class="sc">-</span> <span class="dv">4</span> <span class="co"># minimum brood year</span></span>
<span id="cb94-101"><a href="#cb94-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-102"><a href="#cb94-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-103"><a href="#cb94-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-104"><a href="#cb94-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-105"><a href="#cb94-105" aria-hidden="true" tabindex="-1"></a><span class="fu">## Covariate Data</span></span>
<span id="cb94-106"><a href="#cb94-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-107"><a href="#cb94-107" aria-hidden="true" tabindex="-1"></a>Per Murdoch et al (2023) CJFAS, only include variables for which Pearson's r is &lt; 0.6.</span>
<span id="cb94-108"><a href="#cb94-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-109"><a href="#cb94-109" aria-hidden="true" tabindex="-1"></a>Notes:</span>
<span id="cb94-110"><a href="#cb94-110" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>drop jld_winmean and natq_winmean from same model (pearson r = 0.639 since 1960, 0.79 since 1989)</span>
<span id="cb94-111"><a href="#cb94-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-112"><a href="#cb94-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-113"><a href="#cb94-113" aria-hidden="true" tabindex="-1"></a>Load derived data files</span>
<span id="cb94-116"><a href="#cb94-116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-117"><a href="#cb94-117" aria-hidden="true" tabindex="-1"></a>jldramp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/Derived/JLD_RampDown_Summary_CalendarYear_1960-2022.csv"</span>) <span class="co">#%&gt;% mutate(broodyr = year) %&gt;% select(-year)</span></span>
<span id="cb94-118"><a href="#cb94-118" aria-hidden="true" tabindex="-1"></a>jldflow <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/Derived/JLD_ManagedFlow_Covariates_BroodYear_1960-2022.csv"</span>)</span>
<span id="cb94-119"><a href="#cb94-119" aria-hidden="true" tabindex="-1"></a>natflow <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/Derived/SnakeTribs_NaturalFlow_Covariates_BroodYear_1960-2022.csv"</span>) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">flowstn =</span> site) <span class="co">#%&gt;% filter(site %in% c("SnakeBeFlat", "Salt")) </span></span>
<span id="cb94-120"><a href="#cb94-120" aria-hidden="true" tabindex="-1"></a>airtemp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/Derived/AirTemperature_Covariates_BroodYear_1960-2022.csv"</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"moose"</span>, <span class="st">"afton"</span>)) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">tempstn =</span> site) </span>
<span id="cb94-121"><a href="#cb94-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-122"><a href="#cb94-122" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(natflow<span class="sc">$</span>flowstn)</span>
<span id="cb94-123"><a href="#cb94-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-124"><a href="#cb94-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-125"><a href="#cb94-125" aria-hidden="true" tabindex="-1"></a><span class="fu">### Check correlation</span></span>
<span id="cb94-126"><a href="#cb94-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-127"><a href="#cb94-127" aria-hidden="true" tabindex="-1"></a>Use pairs plots to check correlation among key variables, within datasets:</span>
<span id="cb94-128"><a href="#cb94-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-129"><a href="#cb94-129" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb94-130"><a href="#cb94-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-131"><a href="#cb94-131" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ramp-down: complete</span></span>
<span id="cb94-132"><a href="#cb94-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-135"><a href="#cb94-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-136"><a href="#cb94-136" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(jldramp <span class="sc">%&gt;%</span> <span class="fu">select</span>(jld_rampdur, jld_rampratemindoy, jld_rampratemin_log), <span class="at">progress =</span> <span class="cn">FALSE</span> ) <span class="co"># entire time series</span></span>
<span id="cb94-137"><a href="#cb94-137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-138"><a href="#cb94-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-139"><a href="#cb94-139" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ramp-down: post-1989</span></span>
<span id="cb94-140"><a href="#cb94-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-143"><a href="#cb94-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-144"><a href="#cb94-144" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(jldramp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(jld_rampdur, jld_rampratemindoy, jld_rampratemin_log) , <span class="at">progress =</span> <span class="cn">FALSE</span>) <span class="co"># post-1989</span></span>
<span id="cb94-145"><a href="#cb94-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-146"><a href="#cb94-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-147"><a href="#cb94-147" aria-hidden="true" tabindex="-1"></a><span class="fu">#### JLD flow: complete</span></span>
<span id="cb94-148"><a href="#cb94-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-151"><a href="#cb94-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-152"><a href="#cb94-152" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(jld_winmean, jld_winmin, jld_winvar, jld_summean, jld_peakmag, jld_peaktime), <span class="at">progress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb94-153"><a href="#cb94-153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-154"><a href="#cb94-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-155"><a href="#cb94-155" aria-hidden="true" tabindex="-1"></a><span class="fu">#### JLD flow: post-1989</span></span>
<span id="cb94-156"><a href="#cb94-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-159"><a href="#cb94-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-160"><a href="#cb94-160" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(jldflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(jld_winmean, jld_winvar, jld_summean, jld_peakmag, jld_peaktime), <span class="at">progress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb94-161"><a href="#cb94-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-162"><a href="#cb94-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-163"><a href="#cb94-163" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Nat. flow: complete</span></span>
<span id="cb94-164"><a href="#cb94-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-167"><a href="#cb94-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-168"><a href="#cb94-168" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(natq_annmin, natq_winmean, natq_winvar, natq_peakmag, natq_peaktime), <span class="at">progress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb94-169"><a href="#cb94-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-170"><a href="#cb94-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-171"><a href="#cb94-171" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Nat. flow: post-1989</span></span>
<span id="cb94-172"><a href="#cb94-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-175"><a href="#cb94-175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-176"><a href="#cb94-176" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>, flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(natq_winmean, natq_winvar, natq_peakmag, natq_peaktime), <span class="at">progress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb94-177"><a href="#cb94-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-178"><a href="#cb94-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-179"><a href="#cb94-179" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comb. flow: complete</span></span>
<span id="cb94-180"><a href="#cb94-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-183"><a href="#cb94-183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-184"><a href="#cb94-184" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeBeFlat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(natq_winmean, natq_winvar, natq_peakmag, natq_peaktime), <span class="at">progress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb94-185"><a href="#cb94-185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-186"><a href="#cb94-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-187"><a href="#cb94-187" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comb. flow: post-1989</span></span>
<span id="cb94-188"><a href="#cb94-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-191"><a href="#cb94-191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-192"><a href="#cb94-192" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>, flowstn <span class="sc">==</span> <span class="st">"SnakeBeFlat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(natq_winmean, natq_winvar, natq_peakmag, natq_peaktime), <span class="at">progress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb94-193"><a href="#cb94-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-194"><a href="#cb94-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-195"><a href="#cb94-195" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Temp: complete</span></span>
<span id="cb94-196"><a href="#cb94-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-199"><a href="#cb94-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-200"><a href="#cb94-200" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(airtemp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(tempstn <span class="sc">==</span> <span class="st">"moose"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(temp_falmean, temp_winmean, temp_sprmean, temp_summean), <span class="at">progress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb94-201"><a href="#cb94-201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-202"><a href="#cb94-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-203"><a href="#cb94-203" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Temp: post-1989</span></span>
<span id="cb94-204"><a href="#cb94-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-207"><a href="#cb94-207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-208"><a href="#cb94-208" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(airtemp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>, tempstn <span class="sc">==</span> <span class="st">"moose"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(temp_falmean, temp_winmean, temp_sprmean, temp_summean), <span class="at">progress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb94-209"><a href="#cb94-209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-210"><a href="#cb94-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-211"><a href="#cb94-211" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb94-212"><a href="#cb94-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-213"><a href="#cb94-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-214"><a href="#cb94-214" aria-hidden="true" tabindex="-1"></a>Check correlation among variables across datasets:</span>
<span id="cb94-215"><a href="#cb94-215" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=10, fig.height=10}</span></span>
<span id="cb94-216"><a href="#cb94-216" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- jldramp %&gt;% select(broodyr, jld_rampdur, jld_rampratemindoy, jld_rampratemin_log) %&gt;%</span></span>
<span id="cb94-217"><a href="#cb94-217" aria-hidden="true" tabindex="-1"></a><span class="in">          left_join(jldflow %&gt;% select(broodyr, jld_winmin, jld_summean, jld_peakmag, jld_peaktime)) %&gt;%</span></span>
<span id="cb94-218"><a href="#cb94-218" aria-hidden="true" tabindex="-1"></a><span class="in">          left_join(natflow %&gt;% filter(flowstn == "SnakeNat") %&gt;% select(broodyr, natq_peakmag, natq_peaktime)) %&gt;%</span></span>
<span id="cb94-219"><a href="#cb94-219" aria-hidden="true" tabindex="-1"></a><span class="in">          #left_join(natflow %&gt;% filter(flowstn == "SnakeBeFlat") %&gt;% select(broodyr, natq_winmean)) %&gt;%</span></span>
<span id="cb94-220"><a href="#cb94-220" aria-hidden="true" tabindex="-1"></a><span class="in">          left_join(airtemp %&gt;% filter(tempstn == "moose") %&gt;% select(broodyr, temp_falmean, temp_winmean, temp_sprmean, temp_summean))</span></span>
<span id="cb94-221"><a href="#cb94-221" aria-hidden="true" tabindex="-1"></a><span class="in">range(cor(p, use = "pairwise.complete.obs")[upper.tri(cor(p, use = "pairwise.complete.obs"))])</span></span>
<span id="cb94-222"><a href="#cb94-222" aria-hidden="true" tabindex="-1"></a><span class="in">ggpairs(p, progress = FALSE)</span></span>
<span id="cb94-223"><a href="#cb94-223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-224"><a href="#cb94-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-225"><a href="#cb94-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-226"><a href="#cb94-226" aria-hidden="true" tabindex="-1"></a>Post 1989</span>
<span id="cb94-227"><a href="#cb94-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=10, fig.height=10}</span></span>
<span id="cb94-228"><a href="#cb94-228" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- jldramp %&gt;% filter(broodyr &gt;= 1989) %&gt;% select(broodyr, jld_rampdur, jld_rampratemindoy, jld_rampratemin_log) %&gt;%</span></span>
<span id="cb94-229"><a href="#cb94-229" aria-hidden="true" tabindex="-1"></a><span class="in">          left_join(jldflow %&gt;% filter(broodyr &gt;= 1989) %&gt;% select(broodyr, jld_winmin, jld_summean, jld_peakmag, jld_peaktime)) %&gt;%</span></span>
<span id="cb94-230"><a href="#cb94-230" aria-hidden="true" tabindex="-1"></a><span class="in">          left_join(natflow %&gt;% filter(broodyr &gt;= 1989) %&gt;% filter(flowstn == "SnakeNat") %&gt;% select(broodyr, natq_peakmag, natq_peaktime)) %&gt;%</span></span>
<span id="cb94-231"><a href="#cb94-231" aria-hidden="true" tabindex="-1"></a><span class="in">          #left_join(natflow %&gt;% filter(broodyr &gt;= 1989) %&gt;% filter(flowstn == "SnakeBeFlat") %&gt;% select(broodyr, natq_winmean)) %&gt;%</span></span>
<span id="cb94-232"><a href="#cb94-232" aria-hidden="true" tabindex="-1"></a><span class="in">          left_join(airtemp %&gt;% filter(broodyr &gt;= 1989) %&gt;% filter(tempstn == "moose") %&gt;% select(broodyr, temp_falmean, temp_winmean, temp_sprmean, temp_summean))</span></span>
<span id="cb94-233"><a href="#cb94-233" aria-hidden="true" tabindex="-1"></a><span class="in">range(cor(p, use = "pairwise.complete.obs")[upper.tri(cor(p, use = "pairwise.complete.obs"))])</span></span>
<span id="cb94-234"><a href="#cb94-234" aria-hidden="true" tabindex="-1"></a><span class="in">ggpairs(p, progress = FALSE)</span></span>
<span id="cb94-235"><a href="#cb94-235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-236"><a href="#cb94-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-237"><a href="#cb94-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-238"><a href="#cb94-238" aria-hidden="true" tabindex="-1"></a>Experienced flow</span>
<span id="cb94-239"><a href="#cb94-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=10, fig.height=10}</span></span>
<span id="cb94-240"><a href="#cb94-240" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- jldramp %&gt;% select(broodyr, jld_rampdur, jld_rampratemindoy, jld_rampratemin_log) %&gt;%</span></span>
<span id="cb94-241"><a href="#cb94-241" aria-hidden="true" tabindex="-1"></a><span class="in">          left_join(jldflow %&gt;% select(broodyr, jld_winvar, jld_summean)) %&gt;%</span></span>
<span id="cb94-242"><a href="#cb94-242" aria-hidden="true" tabindex="-1"></a><span class="in">          #left_join(natflow %&gt;% filter(flowstn == "SnakeNat") %&gt;% select(broodyr, natq_peakmag, natq_peaktime)) %&gt;%</span></span>
<span id="cb94-243"><a href="#cb94-243" aria-hidden="true" tabindex="-1"></a><span class="in">          left_join(natflow %&gt;% filter(flowstn == "SnakeBeFlat") %&gt;% select(broodyr, natq_winmean, natq_peakmag, natq_peaktime)) %&gt;%</span></span>
<span id="cb94-244"><a href="#cb94-244" aria-hidden="true" tabindex="-1"></a><span class="in">          left_join(airtemp %&gt;% filter(tempstn == "moose") %&gt;% select(broodyr, temp_falmean, temp_winmean, temp_sprmean, temp_summean)) %&gt;% select(-broodyr)</span></span>
<span id="cb94-245"><a href="#cb94-245" aria-hidden="true" tabindex="-1"></a><span class="in">range(cor(p, use = "complete.obs")[upper.tri(cor(p, use = "complete.obs"))])</span></span>
<span id="cb94-246"><a href="#cb94-246" aria-hidden="true" tabindex="-1"></a><span class="in">ggpairs(p, progress = FALSE)</span></span>
<span id="cb94-247"><a href="#cb94-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-248"><a href="#cb94-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-249"><a href="#cb94-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-250"><a href="#cb94-250" aria-hidden="true" tabindex="-1"></a><span class="fu">### Test specific variables</span></span>
<span id="cb94-251"><a href="#cb94-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-252"><a href="#cb94-252" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Winter flow</span></span>
<span id="cb94-253"><a href="#cb94-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-254"><a href="#cb94-254" aria-hidden="true" tabindex="-1"></a>JLD and natural winter flow highly correlated, especially after 1989</span>
<span id="cb94-257"><a href="#cb94-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-258"><a href="#cb94-258" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_winmean) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, natq_winmean))</span>
<span id="cb94-259"><a href="#cb94-259" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd<span class="sc">$</span>jld_winmean, ddd<span class="sc">$</span>natq_winmean)</span>
<span id="cb94-260"><a href="#cb94-260" aria-hidden="true" tabindex="-1"></a>ddd1 <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>)</span>
<span id="cb94-261"><a href="#cb94-261" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd1<span class="sc">$</span>jld_winmean, ddd1<span class="sc">$</span>natq_winmean)</span>
<span id="cb94-262"><a href="#cb94-262" aria-hidden="true" tabindex="-1"></a>ddd1 <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&lt;</span> <span class="dv">1989</span>)</span>
<span id="cb94-263"><a href="#cb94-263" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd1<span class="sc">$</span>jld_winmean, ddd1<span class="sc">$</span>natq_winmean)</span>
<span id="cb94-264"><a href="#cb94-264" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-265"><a href="#cb94-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-266"><a href="#cb94-266" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Peak timing</span></span>
<span id="cb94-267"><a href="#cb94-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-268"><a href="#cb94-268" aria-hidden="true" tabindex="-1"></a>While the timing of peak natural vs. managed flows are not correlated during the full or either partial time period, this may be driven by years of missing data for JLD peak flows...where there was not a JLD peak. Time series plots are suspicious</span>
<span id="cb94-271"><a href="#cb94-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-272"><a href="#cb94-272" aria-hidden="true" tabindex="-1"></a><span class="co"># peak timing...ok...</span></span>
<span id="cb94-273"><a href="#cb94-273" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_peaktime) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, natq_peaktime))</span>
<span id="cb94-274"><a href="#cb94-274" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd<span class="sc">$</span>jld_peaktime, ddd<span class="sc">$</span>natq_peaktime)</span>
<span id="cb94-275"><a href="#cb94-275" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ddd<span class="sc">$</span>jld_peaktime, ddd<span class="sc">$</span>natq_peaktime, <span class="at">ylab =</span> <span class="st">"brood year DOY"</span>, <span class="at">xlab =</span> <span class="st">"year"</span>)</span>
<span id="cb94-276"><a href="#cb94-276" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(jld_peaktime <span class="sc">~</span> broodyr, ddd, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb94-277"><a href="#cb94-277" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(natq_peaktime <span class="sc">~</span> broodyr, ddd, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb94-278"><a href="#cb94-278" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"JLD"</span>, <span class="st">"natural"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))</span>
<span id="cb94-279"><a href="#cb94-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-280"><a href="#cb94-280" aria-hidden="true" tabindex="-1"></a>ddd1 <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>)</span>
<span id="cb94-281"><a href="#cb94-281" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd1<span class="sc">$</span>jld_peaktime, ddd1<span class="sc">$</span>natq_peaktime)</span>
<span id="cb94-282"><a href="#cb94-282" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(ddd1$jld_peaktime, ddd1$natq_peaktime)</span></span>
<span id="cb94-283"><a href="#cb94-283" aria-hidden="true" tabindex="-1"></a><span class="co">#abline(a = 0, b = 1)</span></span>
<span id="cb94-284"><a href="#cb94-284" aria-hidden="true" tabindex="-1"></a>ddd1 <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&lt;</span> <span class="dv">1989</span>)</span>
<span id="cb94-285"><a href="#cb94-285" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd1<span class="sc">$</span>jld_peaktime, ddd1<span class="sc">$</span>natq_peaktime)</span>
<span id="cb94-286"><a href="#cb94-286" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(ddd1$jld_peaktime, ddd1$natq_peaktime)</span></span>
<span id="cb94-287"><a href="#cb94-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-288"><a href="#cb94-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-289"><a href="#cb94-289" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Peak magnitude</span></span>
<span id="cb94-290"><a href="#cb94-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-291"><a href="#cb94-291" aria-hidden="true" tabindex="-1"></a>No multicollinearity issues between the magnitude of peak natural vs. managed flows, although these variables are somewhat correlated prior to 1989.</span>
<span id="cb94-294"><a href="#cb94-294" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-295"><a href="#cb94-295" aria-hidden="true" tabindex="-1"></a><span class="co"># peak magnitude...ok...</span></span>
<span id="cb94-296"><a href="#cb94-296" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_peakmag) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, natq_peakmag))</span>
<span id="cb94-297"><a href="#cb94-297" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd<span class="sc">$</span>jld_peakmag, ddd<span class="sc">$</span>natq_peakmag)</span>
<span id="cb94-298"><a href="#cb94-298" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(jld_peakmag <span class="sc">~</span> broodyr, ddd, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">3000</span>,<span class="dv">20000</span>))</span>
<span id="cb94-299"><a href="#cb94-299" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(natq_peakmag <span class="sc">~</span> broodyr, ddd, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb94-300"><a href="#cb94-300" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"JLD"</span>, <span class="st">"natural"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))</span>
<span id="cb94-301"><a href="#cb94-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-302"><a href="#cb94-302" aria-hidden="true" tabindex="-1"></a>ddd1 <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>)</span>
<span id="cb94-303"><a href="#cb94-303" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd1<span class="sc">$</span>jld_peakmag, ddd1<span class="sc">$</span>natq_peakmag)</span>
<span id="cb94-304"><a href="#cb94-304" aria-hidden="true" tabindex="-1"></a>ddd1 <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&lt;</span> <span class="dv">1989</span>)</span>
<span id="cb94-305"><a href="#cb94-305" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd1<span class="sc">$</span>jld_peakmag, ddd1<span class="sc">$</span>natq_peakmag)</span>
<span id="cb94-306"><a href="#cb94-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-307"><a href="#cb94-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-308"><a href="#cb94-308" aria-hidden="true" tabindex="-1"></a><span class="fu">#### JLD peak mag and JLD win min</span></span>
<span id="cb94-309"><a href="#cb94-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-310"><a href="#cb94-310" aria-hidden="true" tabindex="-1"></a>JLD peak flow magnitude and combined winter mean flow are correlated (&gt;0.6)...perhaps an artifact of "good water years"</span>
<span id="cb94-313"><a href="#cb94-313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-314"><a href="#cb94-314" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_peakmag, jld_winmin)</span>
<span id="cb94-315"><a href="#cb94-315" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd<span class="sc">$</span>jld_peakmag, ddd<span class="sc">$</span>jld_winmin)</span>
<span id="cb94-316"><a href="#cb94-316" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(jld_peakmag <span class="sc">~</span> broodyr, ddd, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb94-317"><a href="#cb94-317" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-318"><a href="#cb94-318" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(jld_winmin <span class="sc">~</span> broodyr, ddd, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb94-319"><a href="#cb94-319" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"JLD peak mag"</span>, <span class="st">"Combined winter mean"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))</span>
<span id="cb94-320"><a href="#cb94-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-321"><a href="#cb94-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-322"><a href="#cb94-322" aria-hidden="true" tabindex="-1"></a>ddd1 <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> <span class="dv">1989</span>)</span>
<span id="cb94-323"><a href="#cb94-323" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd1<span class="sc">$</span>jld_peakmag, ddd1<span class="sc">$</span>jld_winmin)</span>
<span id="cb94-324"><a href="#cb94-324" aria-hidden="true" tabindex="-1"></a>ddd1 <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(broodyr <span class="sc">&lt;</span> <span class="dv">1989</span>)</span>
<span id="cb94-325"><a href="#cb94-325" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ddd1<span class="sc">$</span>jld_peakmag, ddd1<span class="sc">$</span>jld_winmin)</span>
<span id="cb94-326"><a href="#cb94-326" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-327"><a href="#cb94-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-328"><a href="#cb94-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-329"><a href="#cb94-329" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lag correlations</span></span>
<span id="cb94-330"><a href="#cb94-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-331"><a href="#cb94-331" aria-hidden="true" tabindex="-1"></a>Check correlations between variables in year t and t+1 (to separate age-0 and age-1 effects).</span>
<span id="cb94-332"><a href="#cb94-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-333"><a href="#cb94-333" aria-hidden="true" tabindex="-1"></a>Winter variation is the only variable that is moderately correlated between time *t* and *t+1* (0.65)</span>
<span id="cb94-336"><a href="#cb94-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-337"><a href="#cb94-337" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(jldramp<span class="sc">$</span>jld_rampdur, <span class="fu">lead</span>(jldramp<span class="sc">$</span>jld_rampdur))</span>
<span id="cb94-338"><a href="#cb94-338" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(jldramp<span class="sc">$</span>jld_rampratemindoy, <span class="fu">lead</span>(jldramp<span class="sc">$</span>jld_rampratemindoy))</span>
<span id="cb94-339"><a href="#cb94-339" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(jldramp<span class="sc">$</span>jld_rampratemin_log, <span class="fu">lead</span>(jldramp<span class="sc">$</span>jld_rampratemin_log))</span>
<span id="cb94-340"><a href="#cb94-340" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(jldflow<span class="sc">$</span>jld_winmin, <span class="fu">lead</span>(jldflow<span class="sc">$</span>jld_winmin))                  <span class="co"># pearsons r = 0.65</span></span>
<span id="cb94-341"><a href="#cb94-341" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(jldflow<span class="sc">$</span>jld_summean, <span class="fu">lead</span>(jldflow<span class="sc">$</span>jld_summean))</span>
<span id="cb94-342"><a href="#cb94-342" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(jldflow<span class="sc">$</span>jld_peakmag, <span class="fu">lead</span>(jldflow<span class="sc">$</span>jld_peakmag))                  <span class="co"># pearsons r = 0.65</span></span>
<span id="cb94-343"><a href="#cb94-343" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(jldflow<span class="sc">$</span>jld_peaktime, <span class="fu">lead</span>(jldflow<span class="sc">$</span>jld_peaktime))</span>
<span id="cb94-344"><a href="#cb94-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-345"><a href="#cb94-345" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">==</span> <span class="st">"SnakeNat"</span>)</span>
<span id="cb94-346"><a href="#cb94-346" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(d<span class="sc">$</span>natq_peakmag, <span class="fu">lead</span>(d<span class="sc">$</span>natq_peakmag))</span>
<span id="cb94-347"><a href="#cb94-347" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(d<span class="sc">$</span>natq_peaktime, <span class="fu">lead</span>(d<span class="sc">$</span>natq_peaktime))</span>
<span id="cb94-348"><a href="#cb94-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-349"><a href="#cb94-349" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> airtemp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(tempstn <span class="sc">==</span> <span class="st">"moose"</span>)</span>
<span id="cb94-350"><a href="#cb94-350" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(d<span class="sc">$</span>temp_falmean, <span class="fu">lead</span>(d<span class="sc">$</span>temp_falmean))</span>
<span id="cb94-351"><a href="#cb94-351" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(d<span class="sc">$</span>temp_winmean, <span class="fu">lead</span>(d<span class="sc">$</span>temp_winmean))</span>
<span id="cb94-352"><a href="#cb94-352" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(d<span class="sc">$</span>temp_sprmean, <span class="fu">lead</span>(d<span class="sc">$</span>temp_sprmean))</span>
<span id="cb94-353"><a href="#cb94-353" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(d<span class="sc">$</span>temp_summean, <span class="fu">lead</span>(d<span class="sc">$</span>temp_summean))</span>
<span id="cb94-354"><a href="#cb94-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-355"><a href="#cb94-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-356"><a href="#cb94-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-357"><a href="#cb94-357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb94-358"><a href="#cb94-358" aria-hidden="true" tabindex="-1"></a><span class="in"># correlations among natural, managed, and combined winter flow</span></span>
<span id="cb94-359"><a href="#cb94-359" aria-hidden="true" tabindex="-1"></a><span class="in">ddd &lt;- jldflow %&gt;% select(broodyr, jld_annmin) %&gt;%</span></span>
<span id="cb94-360"><a href="#cb94-360" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(natflow %&gt;% filter(flowstn == "SnakeNat") %&gt;% select(broodyr, natq_annmin)) %&gt;% </span></span>
<span id="cb94-361"><a href="#cb94-361" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(natflow %&gt;% filter(flowstn == "SnakeBeFlat") %&gt;% select(broodyr, natq_annmin) %&gt;% rename(expq_annmin = natq_annmin)) </span></span>
<span id="cb94-362"><a href="#cb94-362" aria-hidden="true" tabindex="-1"></a><span class="in">ggpairs(ddd)</span></span>
<span id="cb94-363"><a href="#cb94-363" aria-hidden="true" tabindex="-1"></a><span class="in">ggpairs(ddd %&gt;% filter(broodyr &gt;= 1989))</span></span>
<span id="cb94-364"><a href="#cb94-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-365"><a href="#cb94-365" aria-hidden="true" tabindex="-1"></a><span class="in">ddd &lt;- jldflow %&gt;% select(broodyr, jld_peakmag) %&gt;%</span></span>
<span id="cb94-366"><a href="#cb94-366" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(natflow %&gt;% filter(flowstn == "SnakeNat") %&gt;% select(broodyr, natq_peakmag)) %&gt;% </span></span>
<span id="cb94-367"><a href="#cb94-367" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(natflow %&gt;% filter(flowstn == "SnakeBeFlat") %&gt;% select(broodyr, natq_peakmag) %&gt;% rename(expq_peakmag = natq_peakmag)) </span></span>
<span id="cb94-368"><a href="#cb94-368" aria-hidden="true" tabindex="-1"></a><span class="in">ggpairs(ddd)</span></span>
<span id="cb94-369"><a href="#cb94-369" aria-hidden="true" tabindex="-1"></a><span class="in">ggpairs(ddd %&gt;% filter(broodyr &gt;= 1989))</span></span>
<span id="cb94-370"><a href="#cb94-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-371"><a href="#cb94-371" aria-hidden="true" tabindex="-1"></a><span class="in">ddd &lt;- jldflow %&gt;% select(broodyr, jld_peaktime) %&gt;%</span></span>
<span id="cb94-372"><a href="#cb94-372" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(natflow %&gt;% filter(flowstn == "SnakeNat") %&gt;% select(broodyr, natq_peaktime)) %&gt;% </span></span>
<span id="cb94-373"><a href="#cb94-373" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(natflow %&gt;% filter(flowstn == "SnakeBeFlat") %&gt;% select(broodyr, natq_peaktime) %&gt;% rename(expq_peaktime = natq_peaktime)) </span></span>
<span id="cb94-374"><a href="#cb94-374" aria-hidden="true" tabindex="-1"></a><span class="in">ggpairs(ddd)</span></span>
<span id="cb94-375"><a href="#cb94-375" aria-hidden="true" tabindex="-1"></a><span class="in">ggpairs(ddd %&gt;% filter(broodyr &gt;= 1989))</span></span>
<span id="cb94-376"><a href="#cb94-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-377"><a href="#cb94-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-378"><a href="#cb94-378" aria-hidden="true" tabindex="-1"></a><span class="in"># winter flow time series plots</span></span>
<span id="cb94-379"><a href="#cb94-379" aria-hidden="true" tabindex="-1"></a><span class="in">ddd &lt;- jldflow %&gt;% select(broodyr, jld_annmin) %&gt;% </span></span>
<span id="cb94-380"><a href="#cb94-380" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(natflow %&gt;% filter(flowstn == "SnakeNat") %&gt;% select(broodyr, natq_annmin)) %&gt;% </span></span>
<span id="cb94-381"><a href="#cb94-381" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(tot_annmin = jld_annmin + natq_annmin,</span></span>
<span id="cb94-382"><a href="#cb94-382" aria-hidden="true" tabindex="-1"></a><span class="in">         prop_annmin = jld_annmin/tot_annmin) %&gt;% filter(!is.na(tot_annmin))</span></span>
<span id="cb94-383"><a href="#cb94-383" aria-hidden="true" tabindex="-1"></a><span class="in">ddd$cor &lt;- NA</span></span>
<span id="cb94-384"><a href="#cb94-384" aria-hidden="true" tabindex="-1"></a><span class="in">ddd$cor[5:44] &lt;- rollapply(ddd, width = 9, function(x) abs(cor(x[,2], x[,3])), by.column = FALSE)</span></span>
<span id="cb94-385"><a href="#cb94-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-386"><a href="#cb94-386" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(3,1), mar = c(3,4,0.5,0.5), mgp = c(2.5,1,0))</span></span>
<span id="cb94-387"><a href="#cb94-387" aria-hidden="true" tabindex="-1"></a><span class="in">plot(tot_annmin ~ broodyr, ddd, type = "n", ylim = c(0,2500), xlab = "", ylab = "Winter flow (cfs)", bty = "l")</span></span>
<span id="cb94-388"><a href="#cb94-388" aria-hidden="true" tabindex="-1"></a><span class="in">polygon(x = c(ddd$broodyr, rev(ddd$broodyr)), y = c(rep(0, times = dim(ddd)[1]), rev(ddd$tot_annmin)), border = NA, col = "grey")</span></span>
<span id="cb94-389"><a href="#cb94-389" aria-hidden="true" tabindex="-1"></a><span class="in">polygon(x = c(ddd$broodyr, rev(ddd$broodyr)), y = c(rep(0, times = dim(ddd)[1]), rev(ddd$natq_annmin)), border = NA, col = "white")</span></span>
<span id="cb94-390"><a href="#cb94-390" aria-hidden="true" tabindex="-1"></a><span class="in">polygon(x = c(ddd$broodyr, rev(ddd$broodyr)), y = c(rep(0, times = dim(ddd)[1]), rev(ddd$jld_annmin)), border = NA, col = "white")</span></span>
<span id="cb94-391"><a href="#cb94-391" aria-hidden="true" tabindex="-1"></a><span class="in">polygon(x = c(ddd$broodyr, rev(ddd$broodyr)), y = c(rep(0, times = dim(ddd)[1]), rev(ddd$natq_annmin)), border = NA, col = scales::alpha("darkorchid2", 1))</span></span>
<span id="cb94-392"><a href="#cb94-392" aria-hidden="true" tabindex="-1"></a><span class="in">polygon(x = c(ddd$broodyr, rev(ddd$broodyr)), y = c(rep(0, times = dim(ddd)[1]), rev(ddd$jld_annmin)), border = NA, col = scales::alpha("goldenrod1", 1))</span></span>
<span id="cb94-393"><a href="#cb94-393" aria-hidden="true" tabindex="-1"></a><span class="in">legend("topright", legend = c("Total", "Natural", "Managed"), fill = c("grey", "darkorchid2", "goldenrod1"), bty = "n")</span></span>
<span id="cb94-394"><a href="#cb94-394" aria-hidden="true" tabindex="-1"></a><span class="in">plot(prop_annmin ~ broodyr, ddd, type = "l", bty = "l", xlab = "", ylab = "JLD contribution to winter flow")</span></span>
<span id="cb94-395"><a href="#cb94-395" aria-hidden="true" tabindex="-1"></a><span class="in">points(prop_annmin ~ broodyr, ddd, pch = 16)</span></span>
<span id="cb94-396"><a href="#cb94-396" aria-hidden="true" tabindex="-1"></a><span class="in">plot(cor ~ broodyr, ddd, type = "l", bty = "l", xlab = "", ylab = "Correlation (rolling 9-year window)", ylim = c(0,1))</span></span>
<span id="cb94-397"><a href="#cb94-397" aria-hidden="true" tabindex="-1"></a><span class="in">points(cor ~ broodyr, ddd, pch = 16)</span></span>
<span id="cb94-398"><a href="#cb94-398" aria-hidden="true" tabindex="-1"></a><span class="in">abline(h = 0.6, lty = 2, col = "red")</span></span>
<span id="cb94-399"><a href="#cb94-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-400"><a href="#cb94-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-401"><a href="#cb94-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-402"><a href="#cb94-402" aria-hidden="true" tabindex="-1"></a><span class="fu">## Select Covariates and Standardize</span></span>
<span id="cb94-403"><a href="#cb94-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-404"><a href="#cb94-404" aria-hidden="true" tabindex="-1"></a>Pull out relevant variables, trim to temporal extent of redd count data (by brood year. I.e., redd counts start at 1971 but environmental data starts at 1967), and standardize (mean centered and scaled). </span>
<span id="cb94-405"><a href="#cb94-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-408"><a href="#cb94-408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-409"><a href="#cb94-409" aria-hidden="true" tabindex="-1"></a><span class="co"># Managed flow variables</span></span>
<span id="cb94-410"><a href="#cb94-410" aria-hidden="true" tabindex="-1"></a>covsrc_jldq <span class="ot">&lt;-</span> jldramp <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_rampdur, jld_rampratemindoy, jld_rampratemin_log) <span class="sc">%&gt;%</span></span>
<span id="cb94-411"><a href="#cb94-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> minby) <span class="sc">%&gt;%</span></span>
<span id="cb94-412"><a href="#cb94-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(jldflow <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_winmean, jld_winmin, jld_winvar, jld_summean, jld_peakmag, jld_peaktime)) <span class="sc">%&gt;%</span></span>
<span id="cb94-413"><a href="#cb94-413" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(jld_winmin_log = ifelse(jld_winmin_log &lt; 4, NA, jld_winmin_log)) %&gt;%</span></span>
<span id="cb94-414"><a href="#cb94-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_jld_rampdur =</span> <span class="fu">scale</span>(jld_rampdur, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb94-415"><a href="#cb94-415" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_rampratemindoy =</span> <span class="fu">scale</span>(jld_rampratemindoy, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb94-416"><a href="#cb94-416" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_rampratemin_log =</span> <span class="fu">scale</span>(jld_rampratemin_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>],</span>
<span id="cb94-417"><a href="#cb94-417" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_winmean =</span> <span class="fu">scale</span>(jld_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>],</span>
<span id="cb94-418"><a href="#cb94-418" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_winmin =</span> <span class="fu">scale</span>(jld_winmin, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>],</span>
<span id="cb94-419"><a href="#cb94-419" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_winvar =</span> <span class="fu">scale</span>(jld_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>],</span>
<span id="cb94-420"><a href="#cb94-420" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_summean =</span> <span class="fu">scale</span>(jld_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>],</span>
<span id="cb94-421"><a href="#cb94-421" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_peakmag =</span> <span class="fu">scale</span>(jld_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>],</span>
<span id="cb94-422"><a href="#cb94-422" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_peaktime =</span> <span class="fu">scale</span>(jld_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>])</span>
<span id="cb94-423"><a href="#cb94-423" aria-hidden="true" tabindex="-1"></a><span class="co">#ggpairs(covsrc_jldq %&gt;% select(broodyr, jld_rampdur, jld_rampratemindoy, jld_rampratemin_log, jld_winmean, jld_winmin, jld_winvar, jld_summean, jld_peakmag, jld_peaktime))</span></span>
<span id="cb94-424"><a href="#cb94-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-425"><a href="#cb94-425" aria-hidden="true" tabindex="-1"></a><span class="co"># Managed flow variables - ramp-down only</span></span>
<span id="cb94-426"><a href="#cb94-426" aria-hidden="true" tabindex="-1"></a>covsrc_jldq_rd <span class="ot">&lt;-</span> jldramp <span class="sc">%&gt;%</span> <span class="fu">select</span>(broodyr, jld_rampdur, jld_rampratemindoy, jld_rampratemin_log) <span class="sc">%&gt;%</span></span>
<span id="cb94-427"><a href="#cb94-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> minby) <span class="sc">%&gt;%</span></span>
<span id="cb94-428"><a href="#cb94-428" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(jld_rampratemin = ifelse(jld_rampratemin &lt; -2000, NA, jld_rampratemin)) %&gt;%</span></span>
<span id="cb94-429"><a href="#cb94-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_jld_rampdur =</span> <span class="fu">scale</span>(jld_rampdur, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb94-430"><a href="#cb94-430" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_rampratemindoy =</span> <span class="fu">scale</span>(jld_rampratemindoy, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb94-431"><a href="#cb94-431" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_jld_rampratemin_log =</span> <span class="fu">scale</span>(jld_rampratemin_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>])</span>
<span id="cb94-432"><a href="#cb94-432" aria-hidden="true" tabindex="-1"></a><span class="co">#ggpairs(covsrc_jldq_rd %&gt;% select(broodyr, jld_rampdur, jld_rampratemindoy, jld_rampratemin_log))</span></span>
<span id="cb94-433"><a href="#cb94-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-434"><a href="#cb94-434" aria-hidden="true" tabindex="-1"></a><span class="co"># Natural/wild flow variables </span></span>
<span id="cb94-435"><a href="#cb94-435" aria-hidden="true" tabindex="-1"></a>covsrc_natq <span class="ot">&lt;-</span> natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SnakeNat"</span>)) <span class="sc">%&gt;%</span> <span class="co"># make sure flow station is correct!</span></span>
<span id="cb94-436"><a href="#cb94-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(flowstn, broodyr, natq_falmean_log, natq_winmean_log, natq_sprmean_log, natq_summean_log, natq_winvar, natq_peakmag, natq_peaktime) <span class="sc">%&gt;%</span> <span class="co">#rename(flowstn = site) %&gt;% </span></span>
<span id="cb94-437"><a href="#cb94-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> minby) <span class="sc">%&gt;%</span></span>
<span id="cb94-438"><a href="#cb94-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_natq_winvar =</span> <span class="fu">scale</span>(natq_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb94-439"><a href="#cb94-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_natq_falmean_log =</span> <span class="fu">scale</span>(natq_falmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb94-440"><a href="#cb94-440" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_winmean_log =</span> <span class="fu">scale</span>(natq_winmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb94-441"><a href="#cb94-441" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_sprmean_log =</span> <span class="fu">scale</span>(natq_sprmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb94-442"><a href="#cb94-442" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_summean_log =</span> <span class="fu">scale</span>(natq_summean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb94-443"><a href="#cb94-443" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_peakmag =</span> <span class="fu">scale</span>(natq_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb94-444"><a href="#cb94-444" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_peaktime =</span> <span class="fu">scale</span>(natq_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb94-445"><a href="#cb94-445" aria-hidden="true" tabindex="-1"></a><span class="co">#ggpairs(covsrc_natq %&gt;% select(broodyr, natq_falmean_log, natq_winmean_log, natq_sprmean_log, natq_summean_log, natq_winvar, natq_peakmag, natq_peaktime))</span></span>
<span id="cb94-446"><a href="#cb94-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-447"><a href="#cb94-447" aria-hidden="true" tabindex="-1"></a><span class="co"># Experienced flow variables</span></span>
<span id="cb94-448"><a href="#cb94-448" aria-hidden="true" tabindex="-1"></a>covsrc_expq <span class="ot">&lt;-</span> natflow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flowstn <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SnakeBeFlat"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb94-449"><a href="#cb94-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(flowstn, broodyr, natq_winmean, natq_winvar, natq_summean, natq_peakmag, natq_peaktime) <span class="sc">%&gt;%</span></span>
<span id="cb94-450"><a href="#cb94-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> minby) <span class="sc">%&gt;%</span></span>
<span id="cb94-451"><a href="#cb94-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_natq_winmean =</span> <span class="fu">scale</span>(natq_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb94-452"><a href="#cb94-452" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_winvar =</span> <span class="fu">scale</span>(natq_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb94-453"><a href="#cb94-453" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_summean =</span> <span class="fu">scale</span>(natq_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb94-454"><a href="#cb94-454" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_peakmag =</span> <span class="fu">scale</span>(natq_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb94-455"><a href="#cb94-455" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_natq_peaktime =</span> <span class="fu">scale</span>(natq_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>])</span>
<span id="cb94-456"><a href="#cb94-456" aria-hidden="true" tabindex="-1"></a><span class="co">#ggpairs(covsrc_expq %&gt;% select(broodyr, natq_winmean, natq_winvar, natq_summean, natq_peakmag, natq_peaktime))</span></span>
<span id="cb94-457"><a href="#cb94-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-458"><a href="#cb94-458" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperature variables</span></span>
<span id="cb94-459"><a href="#cb94-459" aria-hidden="true" tabindex="-1"></a>covsrc_temp <span class="ot">&lt;-</span> airtemp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(tempstn <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"moose"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb94-460"><a href="#cb94-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(tempstn, broodyr, temp_falmean, temp_winmean, temp_sprmean, temp_summean) <span class="sc">%&gt;%</span> <span class="co">#rename(tempstn = site) %&gt;% #group_by(tempstn) %&gt;%</span></span>
<span id="cb94-461"><a href="#cb94-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(broodyr <span class="sc">&gt;=</span> minby) <span class="sc">%&gt;%</span></span>
<span id="cb94-462"><a href="#cb94-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_temp_falmean =</span> <span class="fu">scale</span>(temp_falmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb94-463"><a href="#cb94-463" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_temp_winmean =</span> <span class="fu">scale</span>(temp_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb94-464"><a href="#cb94-464" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_temp_sprmean =</span> <span class="fu">scale</span>(temp_sprmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>], </span>
<span id="cb94-465"><a href="#cb94-465" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_temp_summean =</span> <span class="fu">scale</span>(temp_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb94-466"><a href="#cb94-466" aria-hidden="true" tabindex="-1"></a><span class="co">#ggpairs(covsrc_temp %&gt;% select(broodyr, temp_falmean, temp_winmean, temp_sprmean, temp_summean))</span></span>
<span id="cb94-467"><a href="#cb94-467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-468"><a href="#cb94-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-469"><a href="#cb94-469" aria-hidden="true" tabindex="-1"></a>Create and write out summary tables (means and standard deviations)</span>
<span id="cb94-472"><a href="#cb94-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-473"><a href="#cb94-473" aria-hidden="true" tabindex="-1"></a><span class="co"># JLD Flow</span></span>
<span id="cb94-474"><a href="#cb94-474" aria-hidden="true" tabindex="-1"></a>covsrc_jldq_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">cov =</span> <span class="fu">c</span>(<span class="st">"z_jld_rampdur"</span>, <span class="st">"z_jld_rampratemindoy"</span>, <span class="st">"z_jld_rampratemin_log"</span>, <span class="st">"z_jld_winmean"</span>, <span class="st">"z_jld_winmin"</span>, <span class="st">"z_jld_winvar"</span>, <span class="st">"z_jld_summean"</span>, <span class="st">"z_jld_peakmag"</span>, <span class="st">"z_jld_peaktime"</span>),</span>
<span id="cb94-475"><a href="#cb94-475" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mean =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_rampdur, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-476"><a href="#cb94-476" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_rampratemindoy, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-477"><a href="#cb94-477" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_rampratemin_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-478"><a href="#cb94-478" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-479"><a href="#cb94-479" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_winmin, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-480"><a href="#cb94-480" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-481"><a href="#cb94-481" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-482"><a href="#cb94-482" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-483"><a href="#cb94-483" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>)),</span>
<span id="cb94-484"><a href="#cb94-484" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_rampdur, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-485"><a href="#cb94-485" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_rampratemindoy, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-486"><a href="#cb94-486" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_rampratemin_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-487"><a href="#cb94-487" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-488"><a href="#cb94-488" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_winmin, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-489"><a href="#cb94-489" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-490"><a href="#cb94-490" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-491"><a href="#cb94-491" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-492"><a href="#cb94-492" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_jldq<span class="sc">$</span>jld_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>)))</span>
<span id="cb94-493"><a href="#cb94-493" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(covsrc_jldq_summary, <span class="st">"Data/Derived/ManagedFlow_SummaryMeanSD_1967-2022.csv"</span>)</span>
<span id="cb94-494"><a href="#cb94-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-495"><a href="#cb94-495" aria-hidden="true" tabindex="-1"></a><span class="co"># Natural Flow</span></span>
<span id="cb94-496"><a href="#cb94-496" aria-hidden="true" tabindex="-1"></a>covsrc_natq_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">cov =</span> <span class="fu">c</span>(<span class="st">"z_natq_falmean_log"</span>, <span class="st">"z_natq_winmean_log"</span>, <span class="st">"z_natq_sprmean_log"</span>, <span class="st">"z_natq_summean_log"</span>, <span class="st">"z_natq_winvar"</span>, <span class="st">"z_natq_peakmag"</span>, <span class="st">"z_natq_peaktime"</span>),</span>
<span id="cb94-497"><a href="#cb94-497" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mean =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_falmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-498"><a href="#cb94-498" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_winmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-499"><a href="#cb94-499" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_sprmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-500"><a href="#cb94-500" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_summean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-501"><a href="#cb94-501" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-502"><a href="#cb94-502" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-503"><a href="#cb94-503" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>)),</span>
<span id="cb94-504"><a href="#cb94-504" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_falmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-505"><a href="#cb94-505" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_winmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-506"><a href="#cb94-506" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_sprmean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-507"><a href="#cb94-507" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_summean_log, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-508"><a href="#cb94-508" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-509"><a href="#cb94-509" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-510"><a href="#cb94-510" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_natq<span class="sc">$</span>natq_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>)))</span>
<span id="cb94-511"><a href="#cb94-511" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(covsrc_natq_summary, <span class="st">"Data/Derived/NaturalFlow_SummaryMeanSD_1975-2022.csv"</span>)</span>
<span id="cb94-512"><a href="#cb94-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-513"><a href="#cb94-513" aria-hidden="true" tabindex="-1"></a><span class="co"># Experienced Flow</span></span>
<span id="cb94-514"><a href="#cb94-514" aria-hidden="true" tabindex="-1"></a>covsrc_expq_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">cov =</span> <span class="fu">c</span>(<span class="st">"z_expq_winmean"</span>, <span class="st">"z_expq_winvar"</span>, <span class="st">"z_expq_summean"</span>, <span class="st">"z_expq_peakmag"</span>, <span class="st">"z_expq_peaktime"</span>),</span>
<span id="cb94-515"><a href="#cb94-515" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mean =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-516"><a href="#cb94-516" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-517"><a href="#cb94-517" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-518"><a href="#cb94-518" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-519"><a href="#cb94-519" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>)),</span>
<span id="cb94-520"><a href="#cb94-520" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-521"><a href="#cb94-521" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_winvar, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-522"><a href="#cb94-522" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-523"><a href="#cb94-523" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_peakmag, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-524"><a href="#cb94-524" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_expq<span class="sc">$</span>natq_peaktime, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>)))</span>
<span id="cb94-525"><a href="#cb94-525" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(covsrc_expq_summary, <span class="st">"Data/Derived/ExperiencedFlow_SummaryMeanSD_1975-2022.csv"</span>)</span>
<span id="cb94-526"><a href="#cb94-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-527"><a href="#cb94-527" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperature</span></span>
<span id="cb94-528"><a href="#cb94-528" aria-hidden="true" tabindex="-1"></a>covsrc_temp_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">cov =</span> <span class="fu">c</span>(<span class="st">"z_temp_falmean"</span>, <span class="st">"z_temp_winmean"</span>, <span class="st">"z_temp_sprmean"</span>, <span class="st">"z_temp_summean"</span>),</span>
<span id="cb94-529"><a href="#cb94-529" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mean =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_temp<span class="sc">$</span>temp_falmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-530"><a href="#cb94-530" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_temp<span class="sc">$</span>temp_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-531"><a href="#cb94-531" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_temp<span class="sc">$</span>temp_sprmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>),</span>
<span id="cb94-532"><a href="#cb94-532" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_temp<span class="sc">$</span>temp_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:center"</span>)),</span>
<span id="cb94-533"><a href="#cb94-533" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_temp<span class="sc">$</span>temp_falmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-534"><a href="#cb94-534" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_temp<span class="sc">$</span>temp_winmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-535"><a href="#cb94-535" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_temp<span class="sc">$</span>temp_sprmean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>),</span>
<span id="cb94-536"><a href="#cb94-536" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">attr</span>(<span class="fu">scale</span>(covsrc_temp<span class="sc">$</span>temp_summean, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>), <span class="st">"scaled:scale"</span>)))</span>
<span id="cb94-537"><a href="#cb94-537" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(covsrc_temp_summary, <span class="st">"Data/Derived/Temperature_SummaryMeanSD_1967-2022.csv"</span>)</span>
<span id="cb94-538"><a href="#cb94-538" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-539"><a href="#cb94-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-540"><a href="#cb94-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-541"><a href="#cb94-541" aria-hidden="true" tabindex="-1"></a><span class="fu">## Join Covariate and Fish Data</span></span>
<span id="cb94-542"><a href="#cb94-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-543"><a href="#cb94-543" aria-hidden="true" tabindex="-1"></a><span class="fu">### Separate natural and managed flow components</span></span>
<span id="cb94-544"><a href="#cb94-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-545"><a href="#cb94-545" aria-hidden="true" tabindex="-1"></a>Age-0 (4-year lag)</span>
<span id="cb94-548"><a href="#cb94-548" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-549"><a href="#cb94-549" aria-hidden="true" tabindex="-1"></a>redds3a <span class="ot">&lt;-</span> redds2</span>
<span id="cb94-550"><a href="#cb94-550" aria-hidden="true" tabindex="-1"></a>redds3a<span class="sc">$</span>broodyr <span class="ot">&lt;-</span> redds3a<span class="sc">$</span>year <span class="sc">-</span> <span class="dv">4</span> <span class="co"># create broodyr variable for joining</span></span>
<span id="cb94-551"><a href="#cb94-551" aria-hidden="true" tabindex="-1"></a>redds3a<span class="sc">$</span>tempstn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(redds3a<span class="sc">$</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>), <span class="st">"afton"</span>, <span class="st">"moose"</span>) <span class="co"># basin ID to match to NWS temp station</span></span>
<span id="cb94-552"><a href="#cb94-552" aria-hidden="true" tabindex="-1"></a>redds3a<span class="sc">$</span>flowstn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(redds3a<span class="sc">$</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>), <span class="st">"Salt"</span>, <span class="st">"SnakeNat"</span>) <span class="co"># basin ID to match to USGS flow station </span></span>
<span id="cb94-553"><a href="#cb94-553" aria-hidden="true" tabindex="-1"></a>redds3a <span class="ot">&lt;-</span> redds3a <span class="sc">%&gt;%</span> </span>
<span id="cb94-554"><a href="#cb94-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_jldq, <span class="at">by =</span> <span class="st">"broodyr"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb94-555"><a href="#cb94-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_natq, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"broodyr"</span>, <span class="st">"flowstn"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb94-556"><a href="#cb94-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_temp, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"broodyr"</span>, <span class="st">"tempstn"</span>))</span>
<span id="cb94-557"><a href="#cb94-557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-558"><a href="#cb94-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-559"><a href="#cb94-559" aria-hidden="true" tabindex="-1"></a>Age-1 (3-year lag)</span>
<span id="cb94-562"><a href="#cb94-562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-563"><a href="#cb94-563" aria-hidden="true" tabindex="-1"></a>redds3b <span class="ot">&lt;-</span> redds2</span>
<span id="cb94-564"><a href="#cb94-564" aria-hidden="true" tabindex="-1"></a>redds3b<span class="sc">$</span>broodyr <span class="ot">&lt;-</span> redds3b<span class="sc">$</span>year <span class="sc">-</span> <span class="dv">3</span> <span class="co"># create broodyr variable for joining</span></span>
<span id="cb94-565"><a href="#cb94-565" aria-hidden="true" tabindex="-1"></a>redds3b<span class="sc">$</span>tempstn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(redds3b<span class="sc">$</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>), <span class="st">"afton"</span>, <span class="st">"moose"</span>) <span class="co"># basin ID to match to NWS temp station</span></span>
<span id="cb94-566"><a href="#cb94-566" aria-hidden="true" tabindex="-1"></a>redds3b<span class="sc">$</span>flowstn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(redds3b<span class="sc">$</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>), <span class="st">"Salt"</span>, <span class="st">"SnakeNat"</span>) <span class="co"># basin ID to match to USGS flow station </span></span>
<span id="cb94-567"><a href="#cb94-567" aria-hidden="true" tabindex="-1"></a>redds3b <span class="ot">&lt;-</span> redds3b <span class="sc">%&gt;%</span> </span>
<span id="cb94-568"><a href="#cb94-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_jldq, <span class="at">by =</span> <span class="st">"broodyr"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb94-569"><a href="#cb94-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_natq, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"broodyr"</span>, <span class="st">"flowstn"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb94-570"><a href="#cb94-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_temp, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"broodyr"</span>, <span class="st">"tempstn"</span>))</span>
<span id="cb94-571"><a href="#cb94-571" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-572"><a href="#cb94-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-573"><a href="#cb94-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-574"><a href="#cb94-574" aria-hidden="true" tabindex="-1"></a><span class="fu">### Experienced flow</span></span>
<span id="cb94-575"><a href="#cb94-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-576"><a href="#cb94-576" aria-hidden="true" tabindex="-1"></a>Age-0 (4-year lag)</span>
<span id="cb94-579"><a href="#cb94-579" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-580"><a href="#cb94-580" aria-hidden="true" tabindex="-1"></a>redds3c <span class="ot">&lt;-</span> redds2</span>
<span id="cb94-581"><a href="#cb94-581" aria-hidden="true" tabindex="-1"></a>redds3c<span class="sc">$</span>broodyr <span class="ot">&lt;-</span> redds3c<span class="sc">$</span>year <span class="sc">-</span> <span class="dv">4</span> <span class="co"># create broodyr variable for joining</span></span>
<span id="cb94-582"><a href="#cb94-582" aria-hidden="true" tabindex="-1"></a>redds3c<span class="sc">$</span>tempstn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(redds3c<span class="sc">$</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>), <span class="st">"afton"</span>, <span class="st">"moose"</span>) <span class="co"># basin ID to match to NWS temp station</span></span>
<span id="cb94-583"><a href="#cb94-583" aria-hidden="true" tabindex="-1"></a>redds3c<span class="sc">$</span>flowstn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(redds3c<span class="sc">$</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>), <span class="st">"Salt"</span>, <span class="st">"SnakeBeFlat"</span>) <span class="co"># basin ID to match to USGS flow station </span></span>
<span id="cb94-584"><a href="#cb94-584" aria-hidden="true" tabindex="-1"></a>redds3c <span class="ot">&lt;-</span> redds3c <span class="sc">%&gt;%</span> </span>
<span id="cb94-585"><a href="#cb94-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_jldq_rd, <span class="at">by =</span> <span class="st">"broodyr"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb94-586"><a href="#cb94-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_expq, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"broodyr"</span>, <span class="st">"flowstn"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb94-587"><a href="#cb94-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_temp, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"broodyr"</span>, <span class="st">"tempstn"</span>))</span>
<span id="cb94-588"><a href="#cb94-588" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-589"><a href="#cb94-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-590"><a href="#cb94-590" aria-hidden="true" tabindex="-1"></a>Age-1 (3-year lag)</span>
<span id="cb94-593"><a href="#cb94-593" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-594"><a href="#cb94-594" aria-hidden="true" tabindex="-1"></a>redds3d <span class="ot">&lt;-</span> redds2</span>
<span id="cb94-595"><a href="#cb94-595" aria-hidden="true" tabindex="-1"></a>redds3d<span class="sc">$</span>broodyr <span class="ot">&lt;-</span> redds3d<span class="sc">$</span>year <span class="sc">-</span> <span class="dv">3</span> <span class="co"># create broodyr variable for joining</span></span>
<span id="cb94-596"><a href="#cb94-596" aria-hidden="true" tabindex="-1"></a>redds3d<span class="sc">$</span>tempstn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(redds3d<span class="sc">$</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>), <span class="st">"afton"</span>, <span class="st">"moose"</span>) <span class="co"># basin ID to match to NWS temp station</span></span>
<span id="cb94-597"><a href="#cb94-597" aria-hidden="true" tabindex="-1"></a>redds3d<span class="sc">$</span>flowstn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(redds3d<span class="sc">$</span>stream <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Christiansen"</span>, <span class="st">"Dave"</span>, <span class="st">"Laker"</span>), <span class="st">"Salt"</span>, <span class="st">"SnakeBeFlat"</span>) <span class="co"># basin ID to match to USGS flow station </span></span>
<span id="cb94-598"><a href="#cb94-598" aria-hidden="true" tabindex="-1"></a>redds3d <span class="ot">&lt;-</span> redds3d <span class="sc">%&gt;%</span> </span>
<span id="cb94-599"><a href="#cb94-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_jldq_rd, <span class="at">by =</span> <span class="st">"broodyr"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb94-600"><a href="#cb94-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_expq, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"broodyr"</span>, <span class="st">"flowstn"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb94-601"><a href="#cb94-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(covsrc_temp, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"broodyr"</span>, <span class="st">"tempstn"</span>))</span>
<span id="cb94-602"><a href="#cb94-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-603"><a href="#cb94-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-604"><a href="#cb94-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-605"><a href="#cb94-605" aria-hidden="true" tabindex="-1"></a><span class="fu">### Write out data files</span></span>
<span id="cb94-608"><a href="#cb94-608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb94-609"><a href="#cb94-609" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(redds3a, <span class="st">"Data/Derived/ReddCounts_WGFD_1971-2021_cleaned_withFlowTempCovariates_SeparateFlowComponents_age0.csv"</span>)</span>
<span id="cb94-610"><a href="#cb94-610" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(redds3b, <span class="st">"Data/Derived/ReddCounts_WGFD_1971-2021_cleaned_withFlowTempCovariates_SeparateFlowComponents_age1.csv"</span>)</span>
<span id="cb94-611"><a href="#cb94-611" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(redds3c, <span class="st">"Data/Derived/ReddCounts_WGFD_1971-2021_cleaned_withFlowTempCovariates_ExperiencedFlow_age0.csv"</span>)</span>
<span id="cb94-612"><a href="#cb94-612" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(redds3d, <span class="st">"Data/Derived/ReddCounts_WGFD_1971-2021_cleaned_withFlowTempCovariates_ExperiencedFlow_age1.csv"</span>)</span>
<span id="cb94-613"><a href="#cb94-613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb94-614"><a href="#cb94-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-615"><a href="#cb94-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-616"><a href="#cb94-616" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb94-617"><a href="#cb94-617" aria-hidden="true" tabindex="-1"></a><span class="in">plot(natq_winmean ~ broodyr, covsrc_expq, type = "b")</span></span>
<span id="cb94-618"><a href="#cb94-618" aria-hidden="true" tabindex="-1"></a><span class="in">plot(natq_winvar ~ broodyr, covsrc_expq, type = "b")</span></span>
<span id="cb94-619"><a href="#cb94-619" aria-hidden="true" tabindex="-1"></a><span class="in">plot(natq_peakmag ~ broodyr, covsrc_expq, type = "b")</span></span>
<span id="cb94-620"><a href="#cb94-620" aria-hidden="true" tabindex="-1"></a><span class="in">plot(natq_peaktime ~ broodyr, covsrc_expq, type = "b")</span></span>
<span id="cb94-621"><a href="#cb94-621" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>